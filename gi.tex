% \documentclass[handout]{beamer}
\documentclass{beamer}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usepackage{amsmath, amsthm, amsfonts, amssymb}
\usepackage{mathrsfs}

\usepackage{oubraces}
\usepackage{array}
\usepackage{varwidth}
\usepackage{array}

\input{tikz_config}

\usepackage[sanserif]{complexity}

% Algorithms
\usepackage[ruled]{algorithm2e}
\SetKw{Continue}{continue}

\usetheme{Madrid}
\usecolortheme{default}

\title[On the Graph Isomorphism problem]{On the Graph Isomorphism problem}
\author{Alexander Mayorov}
\institute[MPI-INF]{Max-Planck Institute for Informatics}

\input{defs}

\begin{document}
	
\frame{\titlepage}

\begin{frame}{Graph Isomorphism Problem}
	
	% \textbf{Intuition}: Two graphs are called isomorphic whenever they are equal up to renaming of vertices.
	
	\begin{definition}[Graph isomorphism]
		Undirected graphs \( G_0 = (V_0, E_0) \) and \( G_1 = (V_1, E_1) \) are called \textbf{isomorphic} (denoted $ G_0 \cong G_1 $) if there exists a bijection $ \sigma : V_0 \to V_1 $ such that \[
		\{u,v\} \in E_0 \iff \{\sigma(u), \sigma(v)\} \in E_1
		\]
	\end{definition}

\newcommand{\graphA}{%
	\raisebox{-.5\height}{%
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (a1) at (0,0) {1};
			\node (a2) at (1.2,0) {2};
			\node (a3) at (1.2,1.2) {3};
			\node (a4) at (0,1.2) {4};
			\draw (a1)--(a2)--(a3)--(a4)--(a1);
		\end{tikzpicture}%
	}%
}

\newcommand{\graphB}{%
	\raisebox{-.5\height}{%
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (b1) at (0,0) {a};
			\node (b2) at (1.2,0) {b};
			\node (b3) at (1.2,1.2) {c};
			\node (b4) at (0,1.2) {d};
			\draw (b1)--(b3);
			\draw (b3)--(b4);
			\draw (b4)--(b2);
			\draw (b2)--(b1);
		\end{tikzpicture}%
	}%
}

\newcommand{\graphC}{%
	\raisebox{-.5\height}{%
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (c1) at (0,0) {$ \alpha $};
			\node (c2) at (1.2,0) {$ \beta $};
			\node (c3) at (2.4,0) {$ \gamma $};
			\node (c4) at (1.2,1.2) {$ \delta $};
			\draw (c1)--(c2)--(c3);
			\draw (c2)--(c4);
		\end{tikzpicture}%
	}%
}

\begin{example}
	\begin{center}
		\renewcommand{\arraystretch}{1.5} % row height
		\begin{tabular}{c c c c c}
			\graphA & $\cong$ & \graphB & $\not\cong$ & \graphC
		\end{tabular}
	\end{center}
\end{example}

\begin{definition}[Graph Isomorphism Problem ($ \GI $)]
	\textbf{Given}: Undirected graphs $ G_0 = (V_0, E_0) $, $ G_1 = (V_1, E_1) $
	
	\textbf{Decide}: Is $ G_0 \cong G_1 $?
\end{definition}
\end{frame}

\begin{frame}{$ \GI $ has a very special status (for all we know)}
	\begin{center}
		\begin{tikzpicture}[scale=1.0, every node/.style={font=\large}]
			% Parameters
			\def\semiMajorAxis{5.5}
			\def\semiMinorAxis{3.5}
			\def\npSubclassLabelOffset{-1.5}
			\def\npSubclassExampleOffset{-1}
			\def\pYCoord{-2.0}
			\def\npiYCoord{0.0}
			\def\npcYCoord{2.0}
			
			\path[use as bounding box] (-6,-3.2) rectangle (6,3.2);
			
			% NP ellipse (main region)
			\path[name path=ellipse] (0,0) ellipse ({\semiMajorAxis} and {\semiMinorAxis});
			\draw[fill=blue!10, thick, name path global=NP] (0,0) ellipse ({\semiMajorAxis} and {\semiMinorAxis});
			\node at (4.7,2.6) {\textbf{NP}};
			
			% Define y positions of boundaries
			\def\yP{-1.0}
			\def\yC{1.0}
			
			% Define horizontal lines for boundaries
			\path[name path=Pline] (-\semiMajorAxis-1,\yP) -- (\semiMajorAxis+1,\yP);
			\path[name path=Cline] (-\semiMajorAxis-1,\yC) -- (\semiMajorAxis+1,\yC);
			
			% Find intersection points
			\path[name intersections={of=ellipse and Pline, by={PL, PR}}];
			\path[name intersections={of=ellipse and Cline, by={CL, CR}}];
			
			% Draw boundary lines exactly clipped to ellipse
			\draw[dashed, thick] (PL) -- (PR);
			\draw[dashed, thick] (CL) -- (CR);
			
			% Region labels
			\node[font=\bfseries, OliveGreenZB!80!black, anchor=east] at (\npSubclassLabelOffset,\pYCoord) {P};
			\node[font=\bfseries, anchor=east] at (\npSubclassLabelOffset,\npiYCoord) {NP-intermediate};
			\node[font=\bfseries, DarkRedZB, anchor=east] at (\npSubclassLabelOffset,\npcYCoord) {NP-complete};
			
			% Example problems (directly inside regions)
			% NPC
			\node[anchor=west] at (\npSubclassExampleOffset,\npcYCoord + 0.5) {SAT, Clique, Coloring,};
			\node[anchor=west] at (\npSubclassExampleOffset,\npcYCoord) {Vertex-Cover, Set-Cover,};
			\node[anchor=west] at (\npSubclassExampleOffset,\npcYCoord - 0.5) {Hitting-Set, Subset-Sum, $ \dots $};
			% NPI
			\node[MagentaZB, anchor=west] (ginode) at (\npSubclassExampleOffset,\npiYCoord) {Graph Isomorphism ($ \GI $)};
			\node[anchor=west] at ($ (ginode.east |- 0,\npiYCoord) + (-0.25,-0.1) $) {, $\dots$};
			% P
			\node[anchor=west] at (\npSubclassExampleOffset,\pYCoord + 0.5) {2-SAT, Edge-Cover, 2-Coloring,};
			\node[anchor=west] at (\npSubclassExampleOffset,\pYCoord) {Primes, Maximal-Matching,};
			\node[anchor=west] at (\npSubclassExampleOffset,\pYCoord - 0.5) {Shortest-Path, $ \dots $};
			
		\end{tikzpicture}
	\end{center}
	\textbf{Warning}: this diagram assumes $ \PH $ does not collapse (long-standing open question) and $ \GI \notin \P $ (open).
\end{frame}

\begin{frame}{Solutions to $ \GI $ have a very nice structure}
	
	\begin{itemize}
		\item Unlike with $ \NP $-complete problems, the space of solutions to $ \GI $ has a lot of structure!
		\item To see this, consider first the isomorphisms between a graph and itself (a.k.a. automorphisms)
	\end{itemize}
	
	
\end{frame}

\input{four_vertex_graph_iso_classes}

\begin{frame}{Automorphism groups as stabilizers}
	\textbf{More generally}: $ \Aut(G) $ is isomorphic to the stabilizer of $ G $ in the vertex renaming operation of $ S_n $ on the set of all graphs with vertices $ \{1, \dots, n\} $.
	
	\textbf{Visualization for $ n = 4 $}:\begin{center}
		\setlength{\extrarowheight}{3pt}
		\begin{columns}
			\begin{column}{0.4\textwidth}
				\begin{tabular}{>{\centering\arraybackslash}m{2cm} >{\centering\arraybackslash}m{2.5cm}}
					Orbit&Stabilizer\\
					\hline\orbitOne&$ S_4 $\\
					\hline\orbitTwo&$ S_4 $\\
					\hline\vspace{5pt}\orbitThree&$ \Z_2 $\\
					\hline\vspace{5pt}\orbitFour&$ \Z_2 $\\
					\hline\orbitFive&$ \gen{(1\,2\,3\,4),(1\,3)} $\\
					\hline\orbitSix&$ \gen{(1\,2\,3\,4),(1\,3)} $
				\end{tabular}
			\end{column}
			\begin{column}{0.4\textwidth}
				\begin{tabular}{>{\centering\arraybackslash}m{2cm} >{\centering\arraybackslash}m{2.5cm}}
					Orbit&Stabilizer\\
					\hline\vspace{5pt}\orbitSeven&$ \gen{(1\,2\,3\,4),(1\,3)} $\\
					\hline\orbitEight&$ \Z_2 \times \Z_2 $\\
					\hline\orbitNine&$ \Z_2 $\\
					\hline\vspace{5pt}\orbitTen&$ \gen{(1\,2\,3\,4),(1\,3)} $\\
					\hline\vspace{5pt}\orbitEleven&$ S_3 $
				\end{tabular}
			\end{column}
		\end{columns}
	\end{center}
\end{frame}

\begin{frame}{High-level overview}
	We will show how to solve $ \GI $ via an intermediate problem:
	\begin{center}
		\begin{tikzpicture}[thick]
			% problems
			\node [block] (gi) {\blocktext{Graph Isomorphism Problem (GI)}};
			\node [block, below=3em of gi] (si) {\blocktext{String Isomorphism Problem (SI)}};
			
			% algorithms
			\node [block, below=3em of si] (algo) {Luks's algorithm};
			
			% reductions
			\draw[->, LightBlueZB] (gi) --node[midway, right]{reduce} (si);
			\draw[->, LightBlueZB] (si) --node[midway, right]{solve} (algo);
			
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt, mirror}] (gi.north west) -- (si.south west) node[pos=0.5,left=10pt,black]{\blocktext{Encode graphs into strings, introduce group}};
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (si.north east) -- (algo.south east) node[pos=0.5,right=10pt,black]{\blocktext{Use group-theoretic machinery}};
		\end{tikzpicture}
	\end{center}
\end{frame}

\begin{frame}{Strings and permutations}
	% Fix some finite set $ \Omega $ and a finite alphabet $ \Sigma $.
	
	A string is a mapping $ u : \Omega \rightarrow \Sigma $ where $ \Omega, \Sigma $ are fixed finite sets.
	
	\textbf{Intuition}: Elements of $ \Omega $ are markers of positions, and values of $ u $ are characters at the corresponding positions.
	
	\begin{definition}[Permutation applied to a string]
		For $ \sigma \in \Sym(\Omega) $, define string $ u^\sigma $ to be \begin{align*}
			u^\sigma : \Omega &\rightarrow \Sigma \\
			\omega &\mapsto u (\sigma^{-1}(\omega))
		\end{align*}
	\end{definition}

	\begin{example}
		Let $ \Omega := \{1, 2, 3\} $ and $ \Sigma := \{a, b, c\} $. Then \[
			abc^{()} = abc \qquad abc^{(1\,2\,3)} = cab \qquad abc^{(1\,3\,2)} = bca
		\] where $ abc $ denotes mapping $ 1 \mapsto a $, $ 2 \mapsto b $, $ 3 \mapsto c $.
	\end{example}

\end{frame}

\begin{frame}{String Isomorphism Problem}
	
	Let $ u, v $ be strings and $ \Gamma \le \Sym(\Omega) $. Define \[
		\Iso_\Gamma(u, v) := \{\gamma \in \Gamma \mid u^\gamma = v\}
	\] We say that $ u $ is $ \Gamma $-isomorphic to $ v $ and write $ u \cong_\Gamma v $ whenever $ \Iso_\Gamma(u, v) \neq \varnothing $.
	
	\begin{definition}[String Isomorphism Problem ($ \SI $)]
		\textbf{Given}: \begin{itemize}
			\item Strings $ u, v $
			\item A generating set of a group $ \Gamma \le \Sym(\Omega) $
		\end{itemize}
	
		\textbf{Decide}: Is $ u \cong_\Gamma v $?
	\end{definition}

	\begin{example}
		Consider $ \Gamma := \gen{(1,\dots,n)} \le S_n = \Sym(\Omega) $ for $ \Omega := \{1, \dots, n\} $.
		
		Then $ u \cong_\Gamma v $ if and only if $ u $ and $ v $ are conjugate words.
	\end{example}
\end{frame}

\newcommand{\giToSiReductionGraphZero}{
	\raisebox{-.5\height}{
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (a1) at (0,1.2) {1};
			\node (a2) at (1.2,1.2) {2};
			\node (a3) at (0,0) {3};
			\node (a4) at (1.2,0) {4};
			\draw (a3)--(a1)--(a2)--(a3)--(a4);
		\end{tikzpicture}
	}
}

\newcommand{\giToSiReductionGraphOne}{
	\raisebox{-.5\height}{
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (b1) at (0,1.2) {3};
			\node (b2) at (1.2,1.2) {2};
			\node (b3) at (0,0) {1};
			\node (b4) at (1.2,0) {4};
			\draw (b3)--(b1)--(b2)--(b3)--(b4);
		\end{tikzpicture}
	}
}

% The essence of the above reduction is to ``lift`` isomorphism test from the level of nodes to the level of edges.

\begin{frame}{Towards a reduction from $ \GI $ to $ \SI $}
	\only<1|handout:1>{We reduce the following $ \GI $ instance to $ \SI $:\begin{center}
		\renewcommand{\arraystretch}{1.5} % row height
		\begin{tabular}{c c c}
			$ G_0 $ && $ G_1 $\\
			\giToSiReductionGraphZero & $\overset{?}{\cong}$ & \giToSiReductionGraphOne
		\end{tabular}
	\end{center}}
	\only<1|handout:1>{\textbf{Idea}: encode existence of edges into a string:}
	\only<1-2|handout:1-2>{\begin{center}
		\begin{tabular}{c|c c c c c c}
			$ \omega \in \Omega $ & $ \{1, 2\} $ & $ \{1, 3\} $ & $ \{1, 4\} $ & $ \{2, 3\} $ & $ \{2, 4\} $ & $ \{3, 4\} $\\
			\hline
			$ u_0(\omega) $ & $ 1 $ & $ 1 $ & $ 0 $ & $ 1 $ & $ 0 $ & $ 1 $\\
			$ u_1(\omega) $ & $ 1 $ & $ 1 $ & $ 1 $ & $ 1 $ & $ 0 $ & $ 0 $
		\end{tabular}
	\end{center}}
	\only<2-3|handout:2-3>{This $ \SI $ instance has the following solution:\begin{center}
		\begin{tikzpicture}[thick]
			
			% labels
			\node (l12) {$\{1,2\}$};
			\node[right=.5em of l12] (l13) {$\{1,3\}$};
			\node[right=.5em of l13] (l14) {$\{1,4\}$};
			\node[right=.5em of l14] (l23) {$\{2,3\}$};
			\node[right=.5em of l23] (l24) {$\{2,4\}$};
			\node[right=.5em of l24] (l34) {$\{3,4\}$};
			
			% u_0
			\node[below=.5em of l12] (u0at12) {$ 1 $};
			\node[below=.5em of l13] (u0at13) {$ 1 $};
			\node[below=.5em of l14] (u0at14) {$ 0 $};
			\node[below=.5em of l23] (u0at23) {$ 1 $};
			\node[below=.5em of l24] (u0at24) {$ 0 $};
			\node[below=.5em of l34] (u0at34) {$ 1 $};
			
			\node[left=2em of u0at12] {$ u_0 $};
			
			% u_1
			\node[below=4em of u0at12] (u1at12) {$ 1 $};
			\node[below=4em of u0at13] (u1at13) {$ 1 $};
			\node[below=4em of u0at14] (u1at14) {$ 1 $};
			\node[below=4em of u0at23] (u1at23) {$ 1 $};
			\node[below=4em of u0at24] (u1at24) {$ 0 $};
			\node[below=4em of u0at34] (u1at34) {$ 0 $};
			
			\node[left=2em of u1at12] {$ u_1 $};
			
			% edges from v to u_1
			\draw[->, LightBlueZB] (u0at12.south) -- (u1at23.north);
			\draw[->, LightBlueZB] (u0at13.south) -- (u1at13.north);
			\draw[->, LightBlueZB] (u0at14.south) -- (u1at34.north);
			\draw[->, LightBlueZB] (u0at23.south) -- (u1at12.north);
			\draw[->, LightBlueZB] (u0at24.south) -- (u1at24.north);
			\draw[->, LightBlueZB] (u0at34.south) -- (u1at14.north);
			
		\end{tikzpicture}
	\end{center}}
	\only<3|handout:3>{This solution shows the existence of the isomorphism\begin{center}
			\renewcommand{\arraystretch}{1.5} % row height
			\begin{tabular}{c c c}
				\giToSiReductionGraphZero & \begin{tikzpicture}[thick]
					\draw[->] (0,0) --node[midway, above]{$ \sigma := \textcolor{LightBlueZB}{(1\,3)} $} (3,0);
				\end{tikzpicture} & \giToSiReductionGraphOne
			\end{tabular}
	\end{center}}
\end{frame}

\begin{frame}{Without constraints on $ \SI $ we don't have soundness}
	\textbf{\textcolor{DarkRedZB}{Problem}}: this $ \SI $ instance also has the following solution:\begin{center}
		\begin{tikzpicture}[thick]
			
			% labels
			\node (l12) {$\{1,2\}$};
			\node[right=.5em of l12] (l13) {$\{1,3\}$};
			\node[right=.5em of l13] (l14) {$\{1,4\}$};
			\node[right=.5em of l14] (l23) {$\{2,3\}$};
			\node[right=.5em of l23] (l24) {$\{2,4\}$};
			\node[right=.5em of l24] (l34) {$\{3,4\}$};
			
			% u_0
			\node[below=.5em of l12] (u0at12) {$ 1 $};
			\node[below=.5em of l13] (u0at13) {$ 1 $};
			\node[below=.5em of l14] (u0at14) {$ 0 $};
			\node[below=.5em of l23] (u0at23) {$ 1 $};
			\node[below=.5em of l24] (u0at24) {$ 0 $};
			\node[below=.5em of l34] (u0at34) {$ 1 $};
			
			\node[left=2em of u0at12] {$ u_0 $};
			
			% u_1
			\node[below=3em of u0at12] (u1at12) {$ 1 $};
			\node[below=3em of u0at13] (u1at13) {$ 1 $};
			\node[below=3em of u0at14] (u1at14) {$ 1 $};
			\node[below=3em of u0at23] (u1at23) {$ 1 $};
			\node[below=3em of u0at24] (u1at24) {$ 0 $};
			\node[below=3em of u0at34] (u1at34) {$ 0 $};
			
			\node[left=2em of u1at12] {$ u_1 $};
			
			% edges from u_0 to u_1
			\draw[->, MagentaZB] (u0at12.south) -- (u1at12.north);
			\draw[->, MagentaZB] (u0at13.south) -- (u1at13.north);
			\draw[->, MagentaZB] (u0at14.south) -- (u1at24.north);
			\draw[->, MagentaZB] (u0at23.south) -- (u1at14.north);
			\draw[->, MagentaZB] (u0at24.south) -- (u1at34.north);
			\draw[->, MagentaZB] (u0at34.south) -- (u1at23.north);
			
		\end{tikzpicture}
	\end{center}\begin{itemize}
		\item This solution does not correspond to any graph isomorphism
		\item $ \rightsquigarrow $ The reduction is complete but not sound!
	\end{itemize}

	\textbf{\textcolor{OliveGreenZB}{Solution}}: Define $ \Gamma $ to contain exactly those permutations that are induced by permutations on vertices.
\end{frame}

%\textbf{Proof idea}: encode each graph into a string such that relabeling vertices corresponds to permuting characters of the string.
\begin{frame}{$ \GI $ reduces to $ \SI $ efficiently}
	\vspace{-4pt}\begin{theorem}
		$ \GI \le_m^p \SI $
	\end{theorem}\vspace{-4pt}
	\begin{proof}
		W.l.o.g. assume $ V_0 = V_1 = \{1, \dots, n\} $. Set $ \Sigma := \{0, 1\} $ and $ \Omega := \{\{i, j\} \mid 1 \le i < j \le n\} $. For $ b \in \{0, 1\} $ let $ u_b $ be a string defined by \[
			u_b(\{i, j\}) = 1 \iff \{i, j\} \in E_b
		\] Then \[
			G_0 \cong G_1 \iff u_0 \cong_{\ImageOf(\psi)} u_1
		\] where $ \psi : S_n \rightarrow \Sym(\Omega) $ is the embedding homomorphism \[
			\psi(\sigma) := \Big(\{i, j\} \mapsto \{\sigma(i), \sigma(j)\}\Big)
		\] Therefore, $ \ImageOf(\psi) = \gen{\psi((1\,2)), \psi((1\,\dots\,n))} $ and the result follows.
	\end{proof}
% This is a yes-instance to the string isomorphism problem because \[
%u_1 = u_0^{\psi((1,3)(2,4))}
%\] Indeed, $ (1,3)(2,4) \in S_4 $ is the relabeling that makes $ G_0 $ equal $ G_1 $.
\end{frame}

\begin{frame}{$ \GI $ for bounded-degree graphs}
	From this point we: \begin{itemize}
		\item assume that the input graphs to $ \GI $ have maximum degree $ \le d $
		\item study the complexity of $ \GI $ in this setting
	\end{itemize}
	
	General idea: \begin{itemize}
		\item Find some structure in $ \Aut(G) $ for bounded-degree graphs
		\item Exploit this structure to obtain a fast algorithm
	\end{itemize}
\end{frame}

\begin{frame}{Groups and their composition factors}
	\vspace{-5pt}\begin{definition}
		Let $ \Gamma $ be a finite group. A \textit{subnormal series} of $ \Gamma $ is a sequence \[
		\{\id\} \trianglelefteq \Gamma_1 \trianglelefteq \Gamma_2 \trianglelefteq \dots \trianglelefteq \Gamma_k = \Gamma
		\] where $ \Gamma_1, \dots, \Gamma_k $ are groups. A subnormal series is a \textit{composition series} of $ \Gamma $ if it is strictly increasing and every $ \Gamma_i/\Gamma_{i-1} $ is simple (factor groups $ \Gamma_i/\Gamma_{i-1} $ are called \textit{composition factors}).
	\end{definition}
	\vspace{-5pt}\begin{theorem}[Jordan-H{\"o}lder]
		Every finite group can be decomposed uniquely into its composition factors.
	\end{theorem}
	\vspace{-5pt}\begin{example}
		The composition series of $ S_n $ is $ \{\id\} \trianglelefteq A_n \trianglelefteq S_n $. Thus, $ S_n $ can be decomposed as $ S_n \cong \Z_2 \rtimes A_n $.
	\end{example}
\end{frame}

\begin{frame}{$ \Gamma_d $-groups}
	\begin{definition}[Luks]
		A finite group $ G $ is a $ \Gamma_d $-group (notation: $ G \in \Gamma_d $) if every composition factor of $ G $ is isomorphic to some subgroup of $ S_d $.
	\end{definition}

	\begin{lemma}
		Let $ G $ be finite group and $ N \trianglelefteq G $. Then \[
			G \in \Gamma_d \iff N \in \Gamma_d \text{ and } G/N \in \Gamma_d
		\]
	\end{lemma}
\end{frame}

\begin{frame}{Automorphism groups of bounded-degree graphs}
	
	\begin{itemize}
		\item It would be nice if $ \Aut(G) \in \Gamma_d $ was true for graphs $ G $ of maximum degree $ \le d $
		\item However, this is not the case:
	\end{itemize}
	\begin{theorem}[Frucht]
		For any finite group $ \Gamma $ there exists a 3-regular graph $ G $ such that $ \Aut(G) \cong \Gamma $
	\end{theorem}
	\begin{itemize}
		\item Fortunately, we can circumvent the problem by fixing a vertex $ v $ and considering $ \Aut(G, v) := \{\sigma \in \Aut(G) \mid \sigma(v) = v\} \le \Aut(G) $.
	\end{itemize}
	\begin{theorem}[Luks]
		Let $ d \ge 2 $. For any graph $ G $ of maximum degree at most $ d $ and $ v \in V(G) $ it holds that $ \Aut(G, v) \in \Gamma_d $.
	\end{theorem}
\end{frame}

\begin{frame}{Proof of Luks's theorem}
	\begin{tikzpicture}[thick]
		
		\node[circle, draw] (v) at (0, 0) {$ v $};
		
		\def\r{0.7}          % base radius
		\def\A{0.05}         % wave amplitude (radial)
		\def\n{24}           % number of waves (integer ensures closure)
		\def\R{3.5}
		
		\draw[blue!70, thick, fill=blue!10, fill opacity=0.15, samples=200, domain=0:360, smooth, variable=\t]
		plot ({(\r + \A*sin(\n*\t)) * cos(\t)}, {(\r + \A*sin(\n*\t)) * sin(\t)});
		
	\end{tikzpicture}
\end{frame}

\begin{frame}{Solving $ \GI$ for bounded-degree graphs}
	By combining this result with the idea of the reduction $ \GI \le_m^p \SI $ that we proved earlier, alongside other insights, one can show: \begin{theorem}[Babai, Luks]
		There is a polynomial-time Turing reduction from $ \GI $ for graphs of maximum degree $ d $ to $ \SI $ for a group $ \Gamma $ whose composition factors are all among the subgroups of $ S_d $.
	\end{theorem}

	Building upon this result (and numerous other ones), Luks has proved: \begin{theorem}[Luks]
		$ \GI $ for graphs of maximum degree $ d $ can be solved in time $ n^{O(d)} $.
	\end{theorem}
\end{frame}

\begin{frame}{Luks's algorithm -- high level overview}
	\textbf{General idea}: Recursively split the strings $ u $, $ v $ of the $ \SI $ instance according to the structure of $ \Aut(G) $.
	
	\begin{enumerate}
		\item Compute the orbits of $ \Gamma $'s action on $ \Omega $
		\item If the action is trivial, return $ u \cong_\Gamma v $ iff $ u = v $
		% \item If $ u $ and $ v $ disagree on some orbit, then return $ u \not\cong_\Gamma v $
		\item If the action is not transitive\footnote{Transitivity means that $ \Gamma $'s action is capable of moving any element of $ \Sym(\Omega) $ to any other element (formally: $ \alpha^\Gamma = \Omega\ \forall \alpha \in \Omega $)} on $ \Omega $:\begin{itemize}
			\item Solve $ \SI $ recursively for all orbits
			\item Return $ u \cong_\Gamma v $ iff all recursive calls give a solution
		\end{itemize}
		\item Find minimal block system $ B_1, \dots, B_k $ of the action of $ \Gamma $ on $ \Omega $ (\textbf{Crucial}: elements $ B_i $ correspond to composition factors of $ \Aut(G) $ which are bounded by $ S_d $ by Luks's Theorem above)
		\item Recursively solve $ \SI $ for every $ B_1, \dots, B_k $
		\item Recursively solve $ \SI $ for the above solutions over $ \Gamma/\KernelOf(\Gamma\rightarrow\{B_1, \dots, B_k\}) $ and forward what the recursive call returns
	\end{enumerate}
\end{frame}

\begin{frame}{Visualization for the non-transitive case}
	\begin{center}
		\begin{tikzpicture}
			\coordinate (blockwidth) at (9, 0);
			\coordinate (blockheight) at (0, .75);
			
			\coordinate (omega1sep) at ($ (0, 0)!0.2!(blockwidth) $);
			\coordinate (omega2sep) at ($ (0, 0)!0.4!(blockwidth) $);
			\coordinate (omegam1sep) at ($ (0, 0)!0.8!(blockwidth) $);
			
			\coordinate (utl) at (0, 0); % top left
			\coordinate (utr) at (blockwidth); % top right
			\coordinate (ubl) at ($ (0,0)-(blockheight) $); % bottom left
			\coordinate (ubr) at ($ (ubl)+(blockwidth) $);
			
			\coordinate (uomega1sept) at ($ (utl-|omega1sep) $);
			\coordinate (uomega1sepb) at ($ (ubl-|omega1sep) $);
			\coordinate (uomega2sept) at ($ (utl-|omega2sep) $);
			\coordinate (uomega2sepb) at ($ (ubl-|omega2sep) $);
			\coordinate (uomegam1sept) at ($ (utl-|omegam1sep) $);
			\coordinate (uomegam1sepb) at ($ (ubl-|omegam1sep) $);
			
			\coordinate (vtl) at ($ (ubl)-(blockheight) $); % top left
			\coordinate (vtr) at ($ (vtl) + (blockwidth) $); % top right
			\coordinate (vbl) at ($ (vtl)-(blockheight) $); % bottom left
			\coordinate (vbr) at ($ (vbl)+(blockwidth) $);
			
			\coordinate (vomega1sept) at ($ (vtl-|omega1sep) $);
			\coordinate (vomega1sepb) at ($ (vbl-|omega1sep) $);
			\coordinate (vomega2sept) at ($ (vtl-|omega2sep) $);
			\coordinate (vomega2sepb) at ($ (vbl-|omega2sep) $);
			\coordinate (vomegam1sept) at ($ (vtl-|omegam1sep) $);
			\coordinate (vomegam1sepb) at ($ (vbl-|omegam1sep) $);
			
			\draw[thick] (uomega1sept)--(uomega1sepb) (uomega2sept)--(uomega2sepb) (uomegam1sept)--(uomegam1sepb);
			\draw[thick] (vomega1sept)--(vomega1sepb) (vomega2sept)--(vomega2sepb) (vomegam1sept)--(vomegam1sepb);
			\draw[thick] (utl) -- (utr) -- (ubr) -- (ubl) -- cycle;
			\draw[thick] (vtl) -- (vtr) -- (vbr) -- (vbl) -- cycle;
			
			\draw[thick, dashed] (ubl)--(vtl) (uomega1sepb)--(vomega1sept) (uomega2sepb)--(vomega2sept) (uomegam1sepb)--(vomegam1sept) (ubr)--(vtr);
			
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt, mirror}] (utl) -- (ubl) node[pos=0.5,left=10pt,black]{$ u $};
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt, mirror}] (vtl) -- (vbl) node[pos=0.5,left=10pt,black]{$ v $};
			
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (utl) -- (uomega1sept) node[pos=0.5,above=10pt,black]{Orbit 1};
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (uomega1sept) -- (uomega2sept) node[pos=0.5,above=10pt,black]{Orbit 2};
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (uomegam1sept) -- (utr) node[pos=0.5,above=10pt,black]{Orbit $ s $};
			
			\draw ($ (uomega2sepb)!0.5!(uomegam1sept) $) node {$ \dots $};
			\draw ($ (vomega2sepb)!0.5!(vomegam1sept) $) node {$ \dots $};
			
			\coordinate (redarr1start) at ($ (vbl)!0.5!(vomega1sepb) $);
			\coordinate (redarr2start) at ($ (vomega1sepb)!0.5!(vomega2sepb) $);
			\coordinate (redarrm1start) at ($ (vomegam1sepb)!0.5!(vbr) $);
			
			\node [below=1 of redarr1start] (rec1) {Recursive call 1};
			\node [below=1.5 of redarr2start] (rec2) {Recursive call 2};
			\node [below=1 of redarrm1start] (recm1) {Recursive call $ s $};
			
			% reductions
			\draw[->, thick, LightBlueZB] (redarr1start) -- (rec1);
			\draw[->, thick, LightBlueZB] (redarr2start) -- (rec2);
			\draw[->, thick, LightBlueZB] (redarrm1start) -- (recm1);
		\end{tikzpicture}
	\end{center}
\end{frame}

\end{document}
\documentclass[handout]{beamer}

\def\fullversion{1}

\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usepackage{amsmath, amsthm, amsfonts, amssymb}
\usepackage{mathrsfs}

\usepackage{oubraces}
\usepackage{array}
\usepackage{varwidth}

\input{utils/tikz_config}

\usepackage[sanserif]{complexity}

% Algorithms
\usepackage[plain]{algorithm2e}
\SetKw{Continue}{continue}
\SetKwIF{If}{ElseIf}{Else}{if}{then}{else if}{else}{} % removes "end" at the end of if statements

\usetheme{Madrid}
\usecolortheme{default}

\title[Luks's algorithm for Graph Isomorphism]{Luks's algorithm for Graph Isomorphism}
\author{Alexander Mayorov}
\institute[MPI-INF]{Max-Planck Institute for Informatics}

\input{utils/defs}

%\AtBeginSection[]
%{
%	\begin{frame}
%		\frametitle{Table of Contents}
%		\tableofcontents[currentsection]
%	\end{frame}
%}

\begin{document}
	
\frame{\titlepage}

\section{Basics}

\begin{frame}{Graph Isomorphism Problem}
	
	% \textbf{Intuition}: Two graphs are called isomorphic whenever they are equal up to renaming of vertices.
	
	\begin{definition}[Graph isomorphism]
		Undirected graphs \( G_0 = (V_0, E_0) \) and \( G_1 = (V_1, E_1) \) are called \textbf{isomorphic} (denoted $ G_0 \cong G_1 $) if there exists a bijection $ \sigma : V_0 \to V_1 $ such that \[
		\{u,v\} \in E_0 \iff \{\sigma(u), \sigma(v)\} \in E_1
		\]
	\end{definition}

\newcommand{\graphA}{%
	\raisebox{-.5\height}{%
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (a1) at (0,0) {1};
			\node (a2) at (1.2,0) {2};
			\node (a3) at (1.2,1.2) {3};
			\node (a4) at (0,1.2) {4};
			\draw (a1)--(a2)--(a3)--(a4)--(a1);
		\end{tikzpicture}%
	}%
}

\newcommand{\graphB}{%
	\raisebox{-.5\height}{%
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (b1) at (0,0) {a};
			\node (b2) at (1.2,0) {b};
			\node (b3) at (1.2,1.2) {c};
			\node (b4) at (0,1.2) {d};
			\draw (b1)--(b3);
			\draw (b3)--(b4);
			\draw (b4)--(b2);
			\draw (b2)--(b1);
		\end{tikzpicture}%
	}%
}

\newcommand{\graphC}{%
	\raisebox{-.5\height}{%
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (c1) at (0,0) {$ \alpha $};
			\node (c2) at (1.2,0) {$ \beta $};
			\node (c3) at (2.4,0) {$ \gamma $};
			\node (c4) at (1.2,1.2) {$ \delta $};
			\draw (c1)--(c2)--(c3);
			\draw (c2)--(c4);
		\end{tikzpicture}%
	}%
}

\begin{example}
	\begin{center}
		\renewcommand{\arraystretch}{1.5} % row height
		\begin{tabular}{c c c c c}
			\graphA & $\cong$ & \graphB & $\not\cong$ & \graphC
		\end{tabular}
	\end{center}
\end{example}

\begin{definition}[Graph Isomorphism Problem ($ \GI $)]
	\textbf{Given}: Undirected graphs $ G_0 = (V_0, E_0) $, $ G_1 = (V_1, E_1) $
	
	\textbf{Decide}: Is $ G_0 \cong G_1 $?
\end{definition}
\end{frame}

\begin{frame}{$ \GI $ has a very special status (for all we know)}
	\begin{center}
		\input{figures/gi_in_p_np}
	\end{center}
	\textbf{Warning}: this diagram assumes $ \PH $ does not collapse (long-standing open question) and $ \GI \notin \P $ (open).
\end{frame}

\begin{frame}{Automorphism groups of graphs}
	
	\begin{itemize}
		\item Unlike with $ \NP $-complete problems, the space of solutions to $ \GI $ has a lot of structure!
		\item To see this, consider first the isomorphisms between a graph and itself (a.k.a. automorphisms)
	\end{itemize}
	\textbf{Example}: The automorphism group of
	\begin{center}
		\begin{tikzpicture}[thick, scale=0.8]
			% nodes
			\node[grnode] (v1) at (0,0) {1};
			\node[grnode, left=1.5 of v1] (v2) {2};
			\node[grnode, right=1.5 of v1] (v3) {3};
			\node[grnode, above=1 of v2] (v4) {4};
			\node[grnode, above=1 of v3] (v5) {5};
			\node[grnode] (v6) at ($ (v4)!0.5!(v2) - (2,0) $) {6};
			\node[grnode] (v7) at ($ (v3)!0.5!(v5) + (2,0) $) {7};
			\node[grnode, above=1 of v6] (v8) {8};
			\node[grnode, above=1 of v7] (v9) {9};
			
			% edges
			\draw (v1)--(v2) (v1)--(v4);
			\draw (v1)--(v3) (v1)--(v5);
			\draw (v2)--(v4) (v3)--(v5);
			\draw (v4)--(v6) (v4)--(v8);
			\draw (v5)--(v7) (v5)--(v9);
		\end{tikzpicture}
	\end{center}
	\vspace{-5pt}is\[
		\Aut(G) = \gen{(6\,8), (7\,9), (2\,3)(4\,5)(6\,7)(8\,9)} \le S_9
	\]
\end{frame}

\input{figures/four_vertex_graph_iso_classes}

\begin{frame}{Automorphism groups as stabilizers}
	\textbf{Observation}: $ \Aut(G) $ is the stabilizer of $ G $ in the vertex renaming action of $ \Sym(V(G)) $ on the set of all graphs with vertices $ V(G) $.
	
	\textbf{Visualization for $ V(G) = \{1,2,3,4\} $}:\begin{center}
		\setlength{\extrarowheight}{3pt}
		\begin{columns}
			\begin{column}{0.4\textwidth}
				\begin{tabular}{>{\centering\arraybackslash}m{2cm} >{\centering\arraybackslash}m{2.5cm}}
					Orbit&Stabilizer of \textcolor{TurquoiseZB}{$ G $}\\
					\hline\vspace{1pt}\orbitOne&$ S_4 $\\
					\hline\vspace{1pt}\orbitTwo&$ S_4 $\\
					\hline\vspace{1pt}\orbitThree&$ \gen{(1\,3)} $\\
					\hline\vspace{1pt}\orbitFour&$ \gen{(1\,3)} $\\
					\hline\vspace{1pt}\orbitFive&$ \gen{(1\,2\,3\,4),(1\,3)} $\\
					\hline\vspace{1pt}\orbitSix&$ \gen{(1\,2\,3\,4),(1\,3)} $
				\end{tabular}
			\end{column}
			\begin{column}{0.4\textwidth}
				\begin{tabular}{>{\centering\arraybackslash}m{2cm} >{\centering\arraybackslash}m{2.5cm}}
					Orbit&Stabilizer of \textcolor{TurquoiseZB}{$ G $}\\
					\hline\vspace{1pt}\orbitSeven&$ \gen{(1\,4)(2\,3)} $\\
					\hline\vspace{1pt}\orbitEight&$ S_3 $\\
					\hline\vspace{1pt}\orbitNine&$ S_3 $\\
					\hline\vspace{1pt}\orbitTen&$ \gen{(1\,2),(3\,4)} $\\
					\hline\vspace{1pt}\orbitEleven&$ \gen{(1\,2),(3\,4)} $
				\end{tabular}
			\end{column}
		\end{columns}
	\end{center}
\end{frame}

\if\fullversion1
\begin{frame}{In one sense, solutions to $ \GI $ are sets of cosets}
	\begin{itemize}
		\item Let $ \cdot $ denote the vertex renaming action of $ S_n $ on the set of all graphs with vertices $ \{1, \dots, n\} $
		\item Fix one of the input graphs $ G_0 $
		\item In a sense, space of solutions to $ \GI $ is \[
			\{G_1 \mid G_1 \cong G_0\} = S_n \cdot G_0
		\] the orbit of $ G_0 $
		\item Since $ \Aut(G_0) = \Stab(G_0) $ and \begin{align*}
			\varphi : S_n/\Stab(G_0) &\rightarrow S_n \cdot G_0 \\
			\sigma\Stab(G_0) &\mapsto \sigma \cdot G_0
		\end{align*} is a bijection, we get \[
			\{G_1 \mid G_1 \cong G_0\} \overset{1:1}{\longleftrightarrow} S_n/\Aut(G_0)
		\]
		\item $ \rightsquigarrow $ Solutions to $ \GI $ are sets of cosets!
	\end{itemize}
\end{frame}

\begin{frame}{In a different sense, solutions to $ \GI $ are cosets}
	\begin{itemize}
		\item Fix graphs $ G_0 $ and $ G_1 $ and let $ \sigma : V(G_0) \rightarrow V(G_1) $ be an isomorphism
		\item $ \rightsquigarrow $ For any $ \tau \in \Aut(G_0) $, $ \sigma\tau $ is also an isomorphism:\begin{center}
			\begin{tikzpicture}[thick]
				\node (g0) {$ G_0 $};
				\node[right=4 of g0] (g1) {$ G_1 $};
				
				\draw[->, bend left=20, LightBlueZB] (g0) to node[midway, above] {$ \sigma $} (g1);
				\draw[->, LightBlueZB] (g0) to[out=120,in=60,looseness=8] node[midway, above] {$ \Aut(G_0) $} (g0);
			\end{tikzpicture}
		\end{center}
		\item There are no further solutions because for any isomorphisms $ \sigma_1, \sigma_2 $\begin{center}
			\begin{tikzpicture}[thick]
				\node (g0) {$ G_0 $};
				\node[right=4 of g0] (g1) {$ G_1 $};
				
				\draw[->, bend left=20, LightBlueZB] (g0) to node[midway, above] {$ \sigma_1 $} (g1);
				\draw[->, bend right=20, LightBlueZB] (g0) to node[midway, above] {$ \sigma_2 $} (g1);
				\draw[->, LightBlueZB] (g0) to[out=120,in=60,looseness=8] node[midway, above] {$ \Aut(G_0) $} (g0);
			\end{tikzpicture}
		\end{center} we have $ \sigma_2^{-1} \sigma_1 \in \Aut(G_0) $ which holds iff $ \sigma_1 \Aut(G_0) = \sigma_2 \Aut(G_0) $
		\item $ \rightsquigarrow $ In this sense, solutions to $ \GI $ are cosets of the form $ \sigma \Aut(G_0) $
	\end{itemize}
\end{frame}
\fi

\begin{frame}{High-level overview}
	We will show how to solve (a fragment of) $ \GI $ via an intermediate problem:
	\begin{center}
		\begin{tikzpicture}[thick]
			% problems
			\node [block] (gi) {\blocktext{Graph Isomorphism Problem (GI)}};
			\node [block, below=3em of gi] (si) {\blocktext{String Isomorphism Problem (SI)}};
			
			% algorithms
			\node [block, below=3em of si] (algo) {Luks's algorithm};
			
			% reductions
			\draw[->, LightBlueZB] (gi) --node[midway, right]{reduce} (si);
			\draw[->, LightBlueZB] (si) --node[midway, right]{solve} (algo);
			
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt, mirror}] (gi.north west) -- (si.south west) node[pos=0.5,left=10pt,black]{\blocktext{Encode graphs into strings, introduce group}};
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (si.north east) -- (algo.south east) node[pos=0.5,right=10pt,black]{\blocktext{Use group-theoretic machinery}};
		\end{tikzpicture}
	\end{center}
\end{frame}

\section{Luks's algorithm}

\begin{frame}{Strings and permutations}
	
	A string is a mapping $ u : D \rightarrow \Sigma $ where $ D, \Sigma $ are fixed finite sets.
	
	\textbf{Intuition}: Elements of $ D $ are markers of positions, and values of $ u $ are characters at the corresponding positions.
	
	\begin{definition}[Permutation applied to a string]
		For $ \sigma \in \Sym(D) $, define string $ u^\sigma $ to be \begin{align*}
			u^\sigma : D &\rightarrow \Sigma \\
			d &\mapsto u (\sigma^{-1}(d))
		\end{align*}
	\end{definition}

	\begin{example}
		Let $ D := \{1, 2, 3\} $ and $ \Sigma := \{a, b, c\} $. Then \[
			abc^{()} = abc \qquad abc^{(1\,2\,3)} = cab \qquad abc^{(1\,3\,2)} = bca
		\] where $ abc $ denotes mapping $ 1 \mapsto a $, $ 2 \mapsto b $, $ 3 \mapsto c $.
	\end{example}

\end{frame}

\begin{frame}{String Isomorphism Problem}
	
	Let $ u, v $ be strings and $ \Gamma \le \Sym(D) $. Define \[
		\Iso_{\Gamma}(u, v) := \{\gamma \in \Gamma \mid u^\gamma = v\}
	\] We say that $ u $ is $ \Gamma $-isomorphic to $ v $ and write $ u \cong_{\Gamma} v $ whenever $ \Iso_{\Gamma}(u, v) \neq \varnothing $.
	
	\begin{definition}[String Isomorphism Problem ($ \SI $)]
		\textbf{Given}: \begin{itemize}
			\item Strings $ u, v $
			\item Group $ \Gamma \le \Sym(D) $ (represented as generating set)
		\end{itemize}
	
		\textbf{Decide}: Is $ u \cong_\Gamma v $?
	\end{definition}

	\begin{example}
		Consider $ \Gamma := \gen{(1\,2\,\dots\,n)} \le S_n = \Sym(D) $ for $ D := \{1, \dots, n\} $.
		
		Then $ u \cong_\Gamma v $ if and only if $ u $ and $ v $ are conjugate words.
	\end{example}
\end{frame}

\newcommand{\giToSiReductionGraphZero}{
	\raisebox{-.5\height}{
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (a1) at (0,1.2) {1};
			\node (a2) at (1.2,1.2) {2};
			\node (a3) at (0,0) {3};
			\node (a4) at (1.2,0) {4};
			\draw (a3)--(a1)--(a2)--(a3)--(a4);
		\end{tikzpicture}
	}
}

\newcommand{\giToSiReductionGraphOne}{
	\raisebox{-.5\height}{
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (b1) at (0,1.2) {3};
			\node (b2) at (1.2,1.2) {2};
			\node (b3) at (0,0) {1};
			\node (b4) at (1.2,0) {4};
			\draw (b3)--(b1)--(b2)--(b3)--(b4);
		\end{tikzpicture}
	}
}

% The essence of the above reduction is to ``lift`` isomorphism test from the level of nodes to the level of edges.

\begin{frame}{Towards a reduction from $ \GI $ to $ \SI $}
	\only<1|handout:1>{We reduce the following $ \GI $ instance to $ \SI $:\begin{center}
		\renewcommand{\arraystretch}{1.5} % row height
		\begin{tabular}{c c c}
			$ G_0 $ && $ G_1 $\\
			\giToSiReductionGraphZero & $\overset{?}{\cong}$ & \giToSiReductionGraphOne
		\end{tabular}
	\end{center}}
	\only<1|handout:1>{\textbf{Idea}: encode existence of edges into a string:}
	\only<1-2|handout:1-2>{\begin{center}
		\begin{tabular}{c|c c c c c c}
			$ d \in D $ & $ \{1, 2\} $ & $ \{1, 3\} $ & $ \{1, 4\} $ & $ \{2, 3\} $ & $ \{2, 4\} $ & $ \{3, 4\} $\\
			\hline
			$ u_0(d) $ & $ 1 $ & $ 1 $ & $ 0 $ & $ 1 $ & $ 0 $ & $ 1 $\\
			$ u_1(d) $ & $ 1 $ & $ 1 $ & $ 1 $ & $ 1 $ & $ 0 $ & $ 0 $
		\end{tabular}
	\end{center}}
	\only<2-3|handout:2-3>{This $ \SI $ instance has the following solution:\begin{center}
		\begin{tikzpicture}[thick]
			
			% labels
			\node (l12) {$\{1,2\}$};
			\node[right=.5em of l12] (l13) {$\{1,3\}$};
			\node[right=.5em of l13] (l14) {$\{1,4\}$};
			\node[right=.5em of l14] (l23) {$\{2,3\}$};
			\node[right=.5em of l23] (l24) {$\{2,4\}$};
			\node[right=.5em of l24] (l34) {$\{3,4\}$};
			
			% u_0
			\node[below=.5em of l12] (u0at12) {$ 1 $};
			\node[below=.5em of l13] (u0at13) {$ 1 $};
			\node[below=.5em of l14] (u0at14) {$ 0 $};
			\node[below=.5em of l23] (u0at23) {$ 1 $};
			\node[below=.5em of l24] (u0at24) {$ 0 $};
			\node[below=.5em of l34] (u0at34) {$ 1 $};
			
			\node[left=2em of u0at12] {$ u_0 $};
			
			% u_1
			\node[below=4em of u0at12] (u1at12) {$ 1 $};
			\node[below=4em of u0at13] (u1at13) {$ 1 $};
			\node[below=4em of u0at14] (u1at14) {$ 1 $};
			\node[below=4em of u0at23] (u1at23) {$ 1 $};
			\node[below=4em of u0at24] (u1at24) {$ 0 $};
			\node[below=4em of u0at34] (u1at34) {$ 0 $};
			
			\node[left=2em of u1at12] {$ u_1 $};
			
			% edges from v to u_1
			\draw[->, LightBlueZB] (u0at12.south) -- (u1at23.north);
			\draw[->, LightBlueZB] (u0at13.south) -- (u1at13.north);
			\draw[->, LightBlueZB] (u0at14.south) -- (u1at34.north);
			\draw[->, LightBlueZB] (u0at23.south) -- (u1at12.north);
			\draw[->, LightBlueZB] (u0at24.south) -- (u1at24.north);
			\draw[->, LightBlueZB] (u0at34.south) -- (u1at14.north);
			
		\end{tikzpicture}
	\end{center}}
	\only<3|handout:3>{This solution shows the existence of the isomorphism\begin{center}
			\renewcommand{\arraystretch}{1.5} % row height
			\begin{tabular}{c c c}
				\giToSiReductionGraphZero & \begin{tikzpicture}[thick]
					\draw[->] (0,0) --node[midway, above]{$ \sigma := \textcolor{LightBlueZB}{(1\,3)} $} (3,0);
				\end{tikzpicture} & \giToSiReductionGraphOne
			\end{tabular}
	\end{center}}
\end{frame}

\begin{frame}{Without constraints on $ \SI $ we don't have soundness}
	\textbf{\textcolor{DarkRedZB}{Problem}}: this $ \SI $ instance also has the following solution:\begin{center}
		\begin{tikzpicture}[thick]
			
			% labels
			\node (l12) {$\{1,2\}$};
			\node[right=.5em of l12] (l13) {$\{1,3\}$};
			\node[right=.5em of l13] (l14) {$\{1,4\}$};
			\node[right=.5em of l14] (l23) {$\{2,3\}$};
			\node[right=.5em of l23] (l24) {$\{2,4\}$};
			\node[right=.5em of l24] (l34) {$\{3,4\}$};
			
			% u_0
			\node[below=.5em of l12] (u0at12) {$ 1 $};
			\node[below=.5em of l13] (u0at13) {$ 1 $};
			\node[below=.5em of l14] (u0at14) {$ 0 $};
			\node[below=.5em of l23] (u0at23) {$ 1 $};
			\node[below=.5em of l24] (u0at24) {$ 0 $};
			\node[below=.5em of l34] (u0at34) {$ 1 $};
			
			\node[left=2em of u0at12] {$ u_0 $};
			
			% u_1
			\node[below=3em of u0at12] (u1at12) {$ 1 $};
			\node[below=3em of u0at13] (u1at13) {$ 1 $};
			\node[below=3em of u0at14] (u1at14) {$ 1 $};
			\node[below=3em of u0at23] (u1at23) {$ 1 $};
			\node[below=3em of u0at24] (u1at24) {$ 0 $};
			\node[below=3em of u0at34] (u1at34) {$ 0 $};
			
			\node[left=2em of u1at12] {$ u_1 $};
			
			% edges from u_0 to u_1
			\draw[->, MagentaZB] (u0at12.south) -- (u1at12.north);
			\draw[->, MagentaZB] (u0at13.south) -- (u1at13.north);
			\draw[->, MagentaZB] (u0at14.south) -- (u1at24.north);
			\draw[->, MagentaZB] (u0at23.south) -- (u1at14.north);
			\draw[->, MagentaZB] (u0at24.south) -- (u1at34.north);
			\draw[->, MagentaZB] (u0at34.south) -- (u1at23.north);
			
		\end{tikzpicture}
	\end{center}\begin{itemize}
		\item This solution does not correspond to any graph isomorphism
		\item $ \rightsquigarrow $ The reduction is complete but not sound!
	\end{itemize}

	\textbf{\textcolor{OliveGreenZB}{Solution}}: Define $ \Gamma $ to contain exactly those permutations that are induced by permutations on vertices.
\end{frame}

%\textbf{Proof idea}: encode each graph into a string such that relabeling vertices corresponds to permuting characters of the string.
\begin{frame}{$ \GI $ reduces to $ \SI $ efficiently}
	\vspace{-4pt}\begin{theorem}
		$ \GI \le_m^p \SI $
	\end{theorem}\vspace{-4pt}
	\begin{proof}
		W.l.o.g. assume $ V_0 = V_1 = \{1, \dots, n\} $. Set $ \Sigma := \{0, 1\} $ and $ D := \{\{i, j\} \mid 1 \le i < j \le n\} $. For $ b \in \{0, 1\} $ let $ u_b $ be a string defined by \[
			u_b(\{i, j\}) = 1 \iff \{i, j\} \in E_b
		\] Then \[
			G_0 \cong G_1 \iff u_0 \cong_{\ImageOf(\varphi)} u_1
		\] where $ \varphi : S_n \rightarrow \Sym(D) $ is the embedding homomorphism \[
			\varphi(\sigma) := \Big(\{i, j\} \mapsto \{\sigma(i), \sigma(j)\}\Big)
		\] Therefore, $ \ImageOf(\psi) = \gen{\varphi((1\,2)), \varphi((1\,\dots\,n))} $ and the result follows.
	\end{proof}
\end{frame}

\begin{frame}{$ \GI $ for bounded-degree graphs}
	From this point we: \begin{itemize}
		\item assume that the input graphs to $ \GI $ have maximum degree $ \le d $
		\item assume that $ d \le O(1) $
		\item study the complexity of $ \GI $ in this setting
	\end{itemize}
	
	General idea: \begin{itemize}
		\item Find some structure in $ \Aut(G) $ for bounded-degree graphs
		\item Exploit this structure to obtain a fast algorithm
	\end{itemize}
\end{frame}

\begin{frame}{Groups and their composition factors}
	\vspace{-5pt}\begin{definition}
		Let $ \Gamma $ be a finite group. A \textit{subnormal series} of $ \Gamma $ is a sequence \[
		\{\id\} \trianglelefteq \Gamma_1 \trianglelefteq \Gamma_2 \trianglelefteq \dots \trianglelefteq \Gamma_k = \Gamma
		\] where $ \Gamma_1, \dots, \Gamma_k $ are groups. A subnormal series is a \textit{composition series} of $ \Gamma $ if it is strictly increasing and every $ \Gamma_i/\Gamma_{i-1} $ is simple (factor groups $ \Gamma_i/\Gamma_{i-1} $ are called \textit{composition factors}).
	\end{definition}
	\vspace{-5pt}\begin{theorem}[Jordan-H{\"o}lder]
		Every finite group can be decomposed uniquely into its composition factors.
	\end{theorem}
	\vspace{-5pt}\begin{example}
		The composition series of $ S_n $ is $ \{\id\} \trianglelefteq A_n \trianglelefteq S_n $. It corresponds to the decomposition $ S_n \cong \Z_2 \rtimes A_n $.
	\end{example}
\end{frame}

\begin{frame}{$ \GammaD $-groups}
	\begin{definition}[Luks]
		A finite group $ \Gamma $ is a $ \GammaD $-group (notation: $ \Gamma \in \GammaD $) if every composition factor of $ \Gamma $ is isomorphic to some subgroup of $ S_d $.
	\end{definition}

	The class $ \GammaD $ has a lot of nice properties, for example:
	
	\begin{lemma}[$ \GammaD $ closed under subgroups]
		Let $ H $ be a finite $ \GammaD $-group and let $ H' \le H $. Then $ H' \in \GammaD $.
	\end{lemma}

	\begin{lemma}
		Let $ H $ be finite group and $ N \trianglelefteq H $. Then \[
			H \in \GammaD \iff N \in \GammaD \text{ and } H/N \in \GammaD
		\]
	\end{lemma}
\end{frame}

\begin{frame}{Automorphism groups of bounded-degree graphs}
	
	\begin{itemize}
		\item It would be nice if $ \Aut(G) \in \GammaD $ was true for graphs $ G $ of maximum degree $ \le d $
		\item However, this is not the case:
	\end{itemize}
	\begin{theorem}[Frucht]
		For any finite group $ \Gamma $ there exists a 3-regular graph $ G $ such that $ \Aut(G) \cong \Gamma $
	\end{theorem}
	\begin{itemize}
		\item Fortunately, we can circumvent the problem by fixing a vertex $ v $ and considering $ \Aut(G, v) := \{\sigma \in \Aut(G) \mid \sigma(v) = v\} \le \Aut(G) $.
	\end{itemize}
	\begin{theorem}[Luks]
		Let $ d \ge 2 $. For any connected graph $ G $ of maximum degree at most $ d $ and $ v \in V(G) $ it holds that $ \Aut(G, v) \in \GammaD $.
	\end{theorem}
\end{frame}

\begin{frame}{Proof of Luks's theorem}
	\begin{columns}
		\begin{column}{0.65\textwidth}
			\input{figures/luks_autgammad_thm_proof_rdef}
		\end{column}
		\begin{column}{0.35\textwidth}  %%<--- here
			Let $ R_i $ be the subgraph of $ G $ induced by nodes reachable in $ \le i $ steps from $ v $
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}{Proof of Luks's theorem (continued)}
	\begin{columns}
		\begin{column}{0.35\textwidth}
			\input{figures/luks_autgammad_thm_proof_im1toi}
		\end{column}
		\begin{column}{0.65\textwidth}
			We prove $ \Aut(R_i, v) \in \GammaD $ by induction on $ i $.
			
			\textbf{Base case} ($ i = 0 $): $ \Aut(R_0, v) = \{\id\} \in \GammaD $
			
			\textbf{Inductive step}:\begin{itemize}
				\item Since $ \Aut(R_i, v) $ must send vertices in $ V(R_{i-1}) $ to $ V(R_{i-1}) $, \begin{align*}
					\varphi_i : \Aut(R_i, v) &\rightarrow \Aut(R_{i-1}, v)\\
					\sigma &\mapsto \sigma\restrict{V(R_{i-1})}
				\end{align*} is a well-defined epimorphism
				\item By FHT and IH, \[
				\Aut(R_i, v)/\KernelOf(\varphi_i) \cong \Aut(R_{i-1}, v) \overset{\text{IH}}{\in} \GammaD
				\]
				\item By above lemma, it suffices to prove $ \KernelOf(\varphi_i) \in \GammaD $
			\end{itemize}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}{Proof of Luks's theorem (continued)}
	\begin{columns}
		\begin{column}{0.35\textwidth}
			\input{figures/luks_autgammad_thm_proof_im1toi}
		\end{column}
		\begin{column}{0.65\textwidth}
			\textbf{To show}: $ \KernelOf(\varphi_i) \in \GammaD $
			\begin{itemize}
				%\item $ \KernelOf(\varphi_i) $ consists of exactly those $ \sigma \in \Aut(R_{i-1}, v) $ such that $ \sigma(u) = u\ \forall u \in V(R_{i-1}) $
				\item $ \KernelOf(\varphi_i) $ consists of exactly those automorphisms that fix $ V(R_{i-1}) $
				\item Let $ W $ be nodes of $ R_i $ that are not in $ R_{i-1} $
				\item W.l.o.g. $ W $ is an independent set in $ R_i $
				% \item $ \rightsquigarrow $ Agreeing on $ N(w) $ is an equivalence relation
				\item $ \rightsquigarrow $ If $ \sigma(w) = w' $ for some $ \sigma \in \KernelOf(\varphi_i) $ then $ w, w' \in W $ and $ N_{R_i}(w) = N_{R_i}(w') $
				%\pause
				\item Since every node has degree $ \le d $, every $ w \in W $ can agree with $ \le d $ other $ w' \in W $ on the neighborhood
				\item $ \rightsquigarrow \KernelOf(\varphi_i) \cong H \le S_d^m $ for some $ H $
				\item Since $ S_d^m \in \GammaD $ and $ \GammaD $ is closed under subgroups, the result follows
			\end{itemize}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}{Effectivizing Luks's theorem}
	The level-driven construction in the proof of Luks's theorem and the reduction from $ \GI $ to $ \SI $ can be combined into an algorithm for $ \GI $:
	
	\begin{theorem}[Babai, Luks]
		There is a polynomial-time Turing reduction from $ \GI $ for graphs of maximum degree $ d $ to $ \SI $ for $ \GammaD $-groups.
	\end{theorem}

	\textbf{Note}: W.l.o.g. we can assume that $ G_0 $ and $ G_1 $ are both connected
\end{frame}

\begin{frame}{Sketch of proof of Babai-Luks theorem}
	For every $ (e_0, e_1) \in E(G_0) \times E(G_1) $, compute the following gadget $ G $:
	\begin{center}
		\begin{tikzpicture}[scale=0.8, thick]
			
			\def\r{3.25}                % base radius
			\def\A{0.1}                 % inner wave amplitude (radial)
			\def\n{32}                  % number of waves (integer)
			
			\begin{scope}[shift={(-3.5,0)}]
				% nodes
				\node[grnode] (v01) at (0,0) {1};
				\node[grnode, above=1 of v01] (v03) {3};
				\node[grnode, left=.5 of v03] (v02) {2};
				\node[grnode, right=.5 of v03] (v04) {4};
				\node[grnode, above=1 of v03] (v05) {5};
				\node[grnode, above=1.5 of v04] (v06) {6};
				\node[grnode, right=1.5 of v05] (v07) {7};
	
				% edges
				\draw (v01)--(v02) (v01)--(v03);
				\draw (v02)--(v05) (v04)--(v05) (v04)--(v06) (v04)--(v07);
				\draw[DarkRedZB] (v01) -- node[midway, sloped, below] {$ e_0 $} (v04);
				
				\coordinate (center012) at ($ (v01)!0.6!(v02) $);
				\coordinate (center0) at ($ (center012)!0.45!(v07) $);
				
				\begin{scope}[shift={(center0)}]
					\draw[blue!70, thick, fill=blue!10, fill opacity=0.15,
					samples=360, domain=0:360, smooth, variable=\t]
					plot ({(\r + \A*sin(\n*\t)) * cos(\t)}, {(\r + \A*sin(\n*\t)) * sin(\t)});
					\node[blue!70] at (135:3.75) {$ G_0 $};
				\end{scope}
			\end{scope}
			\begin{scope}[shift={(3.5,0)}]
				% nodes
				\node[grnode] (v11) at (0,0) {a};
				\node[grnode, above=1 of v11] (v13) {c};
				\node[grnode, left=.5 of v13] (v12) {b};
				\node[grnode, right=.5 of v13] (v14) {d};
				\node[grnode, above=1 of v13] (v15) {e};
				\node[grnode, above=1.5 of v14] (v16) {f};
				\node[grnode, right=1.5 of v15] (v17) {g};
				
				% edges
				\draw (v11)--(v12) (v11)--(v13);
				\draw (v12)--(v15) (v14)--(v15) (v14)--(v16) (v14)--(v17);
				\draw[DarkRedZB] (v11) -- node[midway, sloped, below] {$ e_1 $} (v14);
				
				\coordinate (center112) at ($ (v11)!0.6!(v12) $);
				\coordinate (center1) at ($ (center112)!0.45!(v17) $);
				
				\begin{scope}[shift={(center1)}]
					\draw[blue!70, thick, fill=blue!10, fill opacity=0.15,
					samples=360, domain=0:360, smooth, variable=\t]
					plot ({(\r + \A*sin(\n*\t)) * cos(\t)}, {(\r + \A*sin(\n*\t)) * sin(\t)});
					\node[blue!70] at (45:3.75) {$ G_1 $};
				\end{scope}
			\end{scope}
			\coordinate (center) at ($ (center0)!0.5!(center1) $);
			\coordinate (vsypos) at ($ (center) + (0,-3.5) $);
			\coordinate (v0coord) at ($ (vsypos) + (-1.5,0) $);
			\coordinate (v1coord) at ($ (vsypos) + (5.5,0) $);
			
			% v_0 and v_1 additional nodes
			\node[grnode, fill=OliveGreenZB!30] (v0) at (v0coord) {$ v_0 $};
			\node[grnode, fill=OliveGreenZB!30] (v1) at (v1coord) {$ v_1 $};
			
			% edges between v_0 and G_0
			\draw[OliveGreenZB, very thick] (v0) to[bend left=20] (v01);
			\draw[OliveGreenZB, very thick] (v0) to[bend right=20] (v04);
			
			% edges between v_1 and G_1
			\draw[OliveGreenZB, very thick] (v1) to[bend left=20] (v11);
			\draw[OliveGreenZB, very thick] (v1) to[bend right=20] (v14);
			
			% v node
			\coordinate (v0v1mid) at ($ (v0)!0.5!(v1) $);
			\node[grnode, fill=OliveGreenZB!30] (v) at ($ (v0v1mid) + (0,-1) $) {$ v $};
			
			% edges to v node
			\draw[OliveGreenZB, very thick] (v0)--(v);
			\draw[OliveGreenZB, very thick] (v1)--(v);
			
		\end{tikzpicture}
	\end{center}
	\vspace{-5pt}\begin{itemize}
		\item $ \Aut(G, v) \neq \{\id\} \iff G_0 \cong G_1\ \text{via}\ \sigma\ \text{such that}\ \sigma(e_0)=e_1$
	\end{itemize}
\end{frame}

\begin{frame}{Introduction to blocks of group actions}
	We start with an example:
	\begin{center}
		\begin{columns}
			\begin{column}{0.4\textwidth}
				\begin{tikzpicture}[scale=1, thick]
					
					% hexagon vertices
					\coordinate (v1) at ({90 - (0)*60}:2);
					\coordinate (v2) at ({90 - (1)*60}:2);
					\coordinate (v3) at ({90 - (2)*60}:2);
					\coordinate (v4) at ({90 - (3)*60}:2);
					\coordinate (v5) at ({90 - (4)*60}:2);
					\coordinate (v6) at ({90 - (5)*60}:2);
					
					% hexagon
					\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
					
					% labels
					\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
					\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
					\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
					\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
					\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
					\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
					
					% 60 degree rotation arrows
					\draw[->, bend left=20, OliveGreenZB] (l1) to node[midway, above] {$ r $} (l2);
					\draw[->, bend left=20, OliveGreenZB] (l2) to (l3);
					\draw[->, bend left=20, OliveGreenZB] (l3) to (l4);
					\draw[->, bend left=20, OliveGreenZB] (l4) to (l5);
					\draw[->, bend left=20, OliveGreenZB] (l5) to (l6);
					\draw[->, bend left=20, OliveGreenZB] (l6) to (l1);
					
					% flip around 1--4 axis
					\draw[<->, LightBlueZB] ($ (l6.east) + (1,0) $) to node[midway, above] {$ f $} ($ (l2.west) - (1,0) $);
					\draw[<->, LightBlueZB] ($ (l5.east) + (1,0) $) to ($ (l3.west) - (1,0) $);
					\draw[<->, LightBlueZB] (l1) .. controls +(-.4, .7) and +(.4, .7) .. (l1);
					\draw[<->, LightBlueZB] (l4) .. controls +(-.4, -.7) and +(.4, -.7) .. (l4);
				\end{tikzpicture}
			\end{column}
			\begin{column}{0.5\textwidth}
				\begin{itemize}
					\item Let $ \Gamma \le S_6 $ be the symmetry group of the hexagon
					\item $ \Gamma = \gen{\textcolor{OliveGreenZB}{r}, \textcolor{LightBlueZB}{f}} $ where $ \textcolor{OliveGreenZB}{r} := \textcolor{OliveGreenZB}{(1\,2\,3\,4\,5\,6)} $ and $ \textcolor{LightBlueZB}{f} := \textcolor{LightBlueZB}{(6\,2)(5\,3)} $
					\item $ \Gamma $ acts on $ \Omega := \{1,2,3,4,5,6\} $ via $ \gamma \cdot \omega := \gamma(\omega) $
				\end{itemize}
			\end{column}
		\end{columns}
	\end{center}
\end{frame}

\begin{frame}{Some subsets of $ \Omega $ only get permuted or translated}
	\textbf{Observation}: for any $ \gamma \in \Gamma $ we have
	\begin{center}
		\input{figures/some_subsets_only_permute_or_translate}
	\end{center}
\end{frame}

\begin{frame}{Not all subsets of $ \Omega $ have this nice behavior}
	Consider $ \{1, 3\} \subseteq \Omega $.
	\begin{center}
		\input{figures/not_all_subsets_permute_or_translate}
	\end{center}
	Then $ \textcolor{LightBlueZB}{f} \cdot \{1, 3\} = \{1, 5\} $ neither permutes nor translates $ \{1, 3\} $
\end{frame}

\begin{frame}{Blocks and block systems}
	% We capture this behavior rigorously:
	\begin{center}
		\vspace{-5pt}\begin{columns}
			\begin{column}{0.6\textwidth}
				\begin{itemize}
					\item Let $ \cdot : \Gamma \times \Omega \rightarrow \Omega $ be an action of $ \Gamma $
					\item A \textit{block} is a set $ \varnothing \neq \Delta \subseteq \Omega $ such that for every $ \gamma \in \Gamma $\begin{itemize}
						\item $ \gamma \cdot \Delta = \Delta $ \textbf{or}
						\item $ (\gamma \cdot \Delta) \cap \Delta = \varnothing $
					\end{itemize}
				\end{itemize}
			\end{column}
			\begin{column}{0.4\textwidth}
				\begin{itemize}
					\item A \textit{block system} of a block $ \Delta $ is the set $ \{\gamma \cdot \Delta \mid \gamma \in \Gamma\} $
					\item \textit{Trivial blocks}: $ \Omega $ and $ \{\omega\} $ for $ \omega \in \Omega $
				\end{itemize}
			\end{column}
		\end{columns}
	\end{center}
	Block systems of non-trivial blocks in above example:
	\vspace{-5pt}\begin{center}
		\input{figures/block_systems_intro_example}
	\end{center}
\end{frame}

\if\fullversion1
\begin{frame}{Primitive actions and groups}
	\begin{itemize}
		\item A block $ \Delta $ (and $ \Delta $'s block system) is called \textit{minimal} if there is no non-trivial block $ \Delta' \supsetneq \Delta $
		\item Above example: $ \{\textcolor{red!80}{\{1,4\}},\textcolor{OliveGreenZB!80}{\{2,5\}},\textcolor{blue!80}{\{3,6\}}\} $ and $ \{\textcolor{red!80}{\{2,4,6\}},\textcolor{blue!80}{\{1,3,5\}}\} $ are minimal but $ \{\{1\}, \{2\}, \{3\}, \{4\}, \{5\}, \{6\}\} $ is not
		\item An action $ \cdot : \Gamma \times \Omega \rightarrow \Omega $ of $ \Gamma $ on $ \Omega $ is called \textit{primitive} if it is transitive and has no non-trivial blocks
		\item A group $ \Gamma \le \Sym(\Omega) $ is called \textit{primitive} if the natural action of $ \Gamma $ on $ \Omega $ (namely $ \gamma \cdot \omega := \gamma(\omega) $) is primitive
	\end{itemize}
	\begin{center}
		\vspace{-10pt}\begin{columns}
			\begin{column}{0.5\textwidth}
				\textbf{Example}:\begin{itemize}
					\item The symmetry group of the pentagon is primitive
					\item Indeed, any non-trivial block system would imply a factorization of $ 5 = \abs{\Omega} $
				\end{itemize}
			\end{column}
			\begin{column}{0.4\textwidth}
				\input{figures/pentagon_sym}
			\end{column}
		\end{columns}
	\end{center}
\end{frame}
\else
\begin{frame}{Minimal blocks and block systems}
	A block $ \Delta $ (and $ \Delta $'s block system) is called \textit{minimal} if there is no non-trivial block $ \Delta' \supsetneq \Delta $
	
	\textbf{Above example} -- following blocks systems are minimal:\begin{center}
		\input{figures/block_systems_intro_example}
	\end{center}
	However, $ \{\{1\}, \{2\}, \{3\}, \{4\}, \{5\}, \{6\}\} $ is not minimal
\end{frame}
\fi

\begin{frame}{Lifting actions from elements to blocks}
	\begin{center}
		\begin{columns}
			\begin{column}{0.6\textwidth}
				\begin{itemize}
					\item Let $ \cdot : \Gamma \times \Omega \rightarrow \Omega $ be an action of group $ \Gamma $ on a set $ \Omega $
					\item Let $ \{\gamma \cdot \Delta \mid \gamma \in \Gamma\} $ be a block system of some block $ \Delta \subseteq \Omega $
					\item Then $ \cdot $ induces an action \begin{align*}
						\psi_\Delta : \Gamma &\rightarrow \Sym(\{\gamma \cdot \Delta \mid \gamma \in \Gamma\})\\
						\gamma' &\mapsto (\gamma \cdot \Delta) \mapsto (\gamma'\gamma) \cdot \Delta
					\end{align*} on the set of blocks!
					%\item We also denote this action using $ \diamond $: \[
					%	\gamma' \diamond (\gamma \cdot \Delta) := (\gamma'\gamma) \cdot \Delta
					%\]
				\end{itemize}
			\end{column}
			\begin{column}{0.4\textwidth}
				\input{figures/lifting_actions_to_blocks}
			\end{column}
		\end{columns}
	\end{center}
\end{frame}

\if\fullversion1
\begin{frame}{Kernels of block-induced homomorphisms}
	\begin{itemize}
		\item Let $ \psi_\Delta : \Gamma \rightarrow \Sym(\{\gamma \cdot \Delta \mid \gamma \in \Gamma\}) $ be the homomorphism induced by the block $ \Delta \subseteq \Omega $
		\item Clearly, \[
			\KernelOf(\psi_\Delta) = \bigcap_{\gamma \in \Gamma} \Stab_{\psi_\Delta}(\gamma \cdot \Delta)
		\]
	\end{itemize}
	\begin{center}
		\input{figures/ker_of_block_induced_hom_extriv}
	\end{center}
\end{frame}
\fi

\begin{frame}{Partitioning groups using block-induced homomorphisms}
	\if\fullversion1
	The interesting case is when $ \KernelOf(\psi_\Delta) $ is non-trivial, for example:
	\else
	Consider $ \KernelOf(\psi_\Delta) $, for example:
	\fi
	\begin{center}
		\input{figures/ker_of_block_induced_hom_exnontriv}
	\end{center}
	\begin{itemize}
		\item $ \Gamma $ can be seen as a union of cosets of $ \KernelOf(\psi_\Delta) $
		\item $ \rightsquigarrow $ If $ T $ is a transversal of $ \KernelOf(\psi_\Delta) $ in $ \Gamma $, then every $ \gamma \in \Gamma $ can be written as $ t\sigma $ for some (unique) $ t \in T $ and $ \sigma \in \KernelOf(\psi_\Delta) $
	\end{itemize}
\end{frame}

\if\fullversion1
\begin{frame}{Computing $ \KernelOf(\psi_\Delta) $ efficiently}
	\textbf{\textcolor{DarkRedZB}{Problem}}: Computing $ \KernelOf(\psi_\Delta) $ by intersecting $ \psi_\Delta $'s stabilizers is computationally hard!
	
	\textbf{\textcolor{OliveGreenZB}{Solution}}: Iteratively restrict the acting group to the current stabilizer:
	
	\begin{itemize}
		\item Let $ \{\Delta_1, \dots, \Delta_k\} := \{\gamma \cdot \Delta \mid \gamma \in \Gamma\} $ be the blocks
		\item Compute $ \Stab_{\psi_\Delta}(\Delta_1) $
		\item Compute $ \psi_\Delta^{(1)} := \psi_\Delta\restrict{\Stab_{\psi_\Delta}(\Delta_1)} $
		\item Compute $ \Stab_{\psi_\Delta^{(1)}}(\Delta_2) $
		\item Compute $ \psi_\Delta^{(2)} := \psi_\Delta^{(1)}\restrict{\Stab_{\psi_\Delta^{(1)}}(\Delta_2)} $
		\item Compute $ \Stab_{\psi_\Delta^{(2)}}(\Delta_3) $
		\item $ \dots $
		\item Compute $ \Stab_{\psi_\Delta^{(k-1)}}(\Delta_k) = \KernelOf(\psi_\Delta) $
	\end{itemize}
	$ \rightsquigarrow $ we fully circumvent the need to intersect groups!
\end{frame}
\fi

\begin{frame}{Luks's algorithm for string isomorphism}
	\vspace{-3pt}\scalebox{0.84}{
		\begin{minipage}{\linewidth}
			\begin{algorithm}[H]
				\SetAlgoLined
				\KwIn{Strings $ u, v : D \rightarrow \Sigma $, a coset $ \Gamma\sigma $ (where $ \Gamma \le \Sym(D) $ and $ \sigma \in \Sym(D) $) and a $ \Gamma $-invariant set $ \Omega \subseteq D $}
				\KwOut{$ \{\delta \in \Gamma\sigma \mid u^\delta(\omega) = v(\omega)\ \forall \omega \in \Omega\} $ represented as a coset}
				\SetKwFunction{strisoluks}{striso}
				\SetKwProg{strisoluksproc}{Function}{}{end}
				\strisoluksproc{\strisoluks{$ u $, $ v $, $ \Gamma\sigma $, $ \Omega $}}{
					\nl\If{$ \sigma \neq \id $}{
						\nl \Return $ \strisoluks(u, v^{\sigma^{-1}}, \Gamma, \Omega) \sigma $\;
					}
					\nl\If{$ \abs{\Omega} = 1 $}{
						\nl Let $ \omega $ be such that $ \Omega = \{\omega\} $\;
						\nl \Return $ \Gamma $ if $ u(\omega) = v(\omega) $ else $ \varnothing $\;
					}
					\nl\If{the action of $ \Gamma $ on $ \Omega $ is not transitive}{
						\nl Compute an orbit $ \Omega' \subsetneq \Omega $\;
						\nl $ \Gamma'\sigma' := \strisoluks(u, v, \Gamma, \Omega') $\;
						\nl \Return $ \strisoluks(u, v, \Gamma'\sigma', \Omega \setminus \Omega') $\;
					}
					\nl Compute a minimal block $ \Delta $ of the action of $ \Gamma $ on $ \Omega $ and the associated block system $ \{\gamma \cdot \Delta \mid \gamma \in \Gamma\} =: \{\Delta_1, \dots, \Delta_k\}$\;
					\if\fullversion1
					\nl Compute $ \KernelOf(\psi_\Delta) = \Stab_{\psi_\Delta^{(k-1)}}(\Delta_k) $\;
					\else
					\nl Compute $ \KernelOf(\psi_\Delta) $\;
					\fi
					\nl Compute a transversal $ T $ of $ \KernelOf(\psi_\Delta) $ in $ \Gamma $\;
					\nl For each $ t \in T $ compute $ \Theta_t \sigma_t := \strisoluks(u, v, \KernelOf(\psi_\Delta)t, \Omega) $\;
					\nl \Return compression of $ \bigcup_{t \in T} \Theta_t\sigma_t $ into a single coset\;
					% \nl \Return $ \bigcup_{t \in T} \strisoluks(u, v, \KernelOf(\psi_\Delta)t, \Omega) $\;
				}
			\end{algorithm}
		\end{minipage}
	}
\end{frame}

\if\fullversion1
\begin{frame}{From coset case to group case}
	\begin{itemize}
		\item More precisely, Luks's algorithm solves a more general variant of $ \SI $ where we are asked to compute \[
		\Iso_{\Gamma\sigma}(u, v) := \{\delta \in \Gamma\sigma \mid u^\delta = v\}
		\] for a coset $ \Gamma\sigma $ of $ \Gamma \le \Sym(D) $
		\item Clearly, \begin{align*}
			u^\delta = v\ \text{for some}\ \delta \in \Gamma\sigma &\iff u^{\gamma\sigma} = v\ \text{for some}\ \gamma \in \Gamma \\
			&\iff u^\gamma = v^{\sigma^{-1}}\ \text{for some}\ \gamma \in \Gamma
		\end{align*}
		\item $ \rightsquigarrow $ Reduction from coset case to group case is correct
	\end{itemize}
\end{frame}
\fi

\begin{frame}{Case when $ \Gamma $ acts intransitively on $ \Omega $}
	% \item Let $ \cdot : \Gamma \times \Omega \rightarrow \Omega $ denote the action of $ \Gamma $ on $ \Omega
	Let $ \omega_1, \dots, \omega_s $ be a transversal of $ \{\Gamma \cdot \omega \mid \omega \in \Omega\} $
	\begin{center}
		\input{figures/luks_intransitive_case}
	\end{center}
	\vspace{-5pt}\textbf{Note}: $ \Gamma \ge \Gamma_1 \ge \Gamma_2 \ge \dots \ge \Gamma_s $
\end{frame}

\section{Analysis of Luks's algorithm}

\if\fullversion1
\begin{frame}{Lifting non-minimal blocks to blocks of blocks}
	Any blocks $ \Delta \subsetneq \Delta' $ of $ \cdot $ can be lifted to blocks of $ \psi_\Delta $ by\begin{itemize}
		\item Writing $ \Delta' $ as a union of blocks in $ \{\gamma \cdot \Delta \mid \gamma \in \Gamma\} $
		\item Treating the sets in that union as elements
	\end{itemize}
	\textbf{Example}:
	\vspace{-20pt}\begin{center}
		\input{figures/lifting_blocks}
	\end{center}
	\vspace{-15pt}$ \rightsquigarrow $ Non-minimality of $ \Delta \implies $ Non-primitivity of $ \psi_\Delta $
\end{frame}

\begin{frame}{Flattening blocks of block-induced actions}
	\vspace{-5pt}Any block of $ \psi_\Delta $ induces a block of $ \cdot $ via union, for example:
	\vspace{-5pt}\begin{center}
		\input{figures/flattening_blocks}
	\end{center}
	\vspace{-10pt}$ \rightsquigarrow $ Non-primitivity of $ \psi_\Delta \implies $ Non-minimality of $ \Delta $
\end{frame}

\begin{frame}{Primitivity and minimality}
	These constructions hold in general and are the essence of the proof of the following connection between primitivity and minimality:
	
	\begin{theorem}
		Let $ \Gamma $ be a group acting on $ \Omega $ with block $ \Delta \subseteq \Omega $. Then \[
			\psi_\Delta\ \text{is primitive} \iff \Delta\ \text{is minimal}
		\]
	\end{theorem}
\end{frame}

\begin{frame}{Classification of primitive groups and application to $ \GammaD $}
	
	A classification of all finite primitive groups is known:
	
	\begin{theorem}[O'Nan-Scott]
		Every finite primitive group $ \Gamma \le \Sym(\Omega) $ is of affine type, of diagonal type, almost simple, the product action of a wreath product or a twisted wreath product.
	\end{theorem}

	Relying on the O'Nan-Scott theorem, it is possible to show that every primitive $ \GammaD $-group is of polynomial size:
	
	\begin{theorem}[Babai, Cameron, P\'{a}lfy]
		For every $ d \ge 1 $ there exists $ c $ such that every primitive $ \GammaD $-group $ \Gamma \le S_n $ has order at most $ n^c $.
	\end{theorem}
\end{frame}

\begin{frame}{Analysis of case when $ \Gamma $ acts transitively on $ \Omega $}
	We apply the above results to analyze the transitive case of Luks's algorithm:
	
	\begin{itemize}
		\item Since $ \Delta $ is minimal, by above theorem, $ \ImageOf(\psi_\Delta) $ is primitive
		\item By FHT, \[
		\Gamma \in \GammaD \implies \Gamma/\KernelOf(\psi_\Delta) \in \GammaD \implies \ImageOf(\psi_\Delta) \in \GammaD
		\]
		\item $ \rightsquigarrow $ By the Babai-Cameron-P\'{a}lfy theorem, \[
		\abs{T} = \abs{\ImageOf(\psi_\Delta)} \le k^c
		\] for some constant $ c $
		\item $ \rightsquigarrow $ The transitive case of Luks's algorithm, excluding costs for recursive calls,\begin{itemize}
			\item runs in polynomial time
			\item makes polynomially many recursive calls
		\end{itemize}
	\end{itemize}
\end{frame}
\else
\begin{frame}{Analysis of case when $ \Gamma $ acts transitively on $ \Omega $}
	\begin{theorem}[Babai, Cameron, P\'{a}lfy (special case, reformulated)]
		For every $ d \ge 1 $ there exists $ c $ such that for every $ \Gamma \in \GammaD $ and action $ \cdot $ of $ \Gamma $ on $ \Omega $ having minimal block $ \Delta $ it holds that $ \abs{\Gamma/\KernelOf(\psi_\Delta)} \le n^c $, where $ n := \abs{\{\gamma \cdot \Delta \mid \gamma \in \Gamma\}} $ is the number of blocks.
	\end{theorem}
	\begin{itemize}
		\item $ \rightsquigarrow $ The transversal size is bounded by \[
		\abs{T} = \abs{\Gamma/\KernelOf(\psi_\Delta)} \le k^c
		\] for some constant $ c $
		\item $ \rightsquigarrow $ The transitive case of Luks's algorithm, excluding costs for recursive calls,\begin{itemize}
			\item runs in polynomial time
			\item makes polynomially many recursive calls
		\end{itemize}
	\end{itemize}
\end{frame}
\fi

\if\fullversion1
\begin{frame}{Time complexity analysis}
	\vspace{-5pt}\begin{claim}
		Let $ \NumLeaves $ be the number of leaves in the tree of recursive calls. Then \[
			\NumLeaves \le \sum_{\Gamma\cdot\omega \in \Omega/\Gamma} \abs{\Gamma\cdot\omega}^{c+1}
		\] where $ c $ is the constant of the Babai-Cameron-P\'{a}lfy theorem above.
	\end{claim}
	We prove the claim by structural induction on the tree:
	
	\textbf{Base case} ($ \abs{\Omega} = 1 $): trivial
	
	\textbf{Inductive step}: First consider the intransitive case:\begin{itemize}
		\item By IH, $ \NumLeaves(\strisoluks(u, v, \Gamma, \Omega')) \le \abs{\Omega'}^{c+1} $
		\item By IH and since $ \Gamma' \le \Gamma $, \[
		\NumLeaves(\strisoluks(u, v, \Gamma'\sigma', \Omega \setminus \Omega')) \le \sum_{\Gamma\cdot\omega \in (\Omega \setminus \Omega')/\Gamma} \abs{\Gamma\cdot\omega}^{c+1}
		\]
		\item $ \rightsquigarrow $ the claim follows if $ \Gamma $ acts intransitively on $ \Omega $
	\end{itemize}
\end{frame}

\begin{frame}{Time complexity analysis -- transitive case}
	\textbf{Assume}: $ \Gamma $ acts transitively on $ \Omega $
	
	\textbf{To show}: \[
	\NumLeaves(\strisoluks{$ u $, $ v $, $ \Gamma\sigma $, $ \Omega $}) \le \abs{\Omega}^{c+1}
	\] \textbf{Proof}:\begin{itemize}
		\item We have already shown: $ \abs{T} \le k^c $
		\item Clearly, \[
		\NumLeaves(\strisoluks{$ u $, $ v $, $ \Gamma\sigma $, $ \Omega $}) \le k^c \cdot \NumLeaves(\Theta_t\sigma_t)
		\] where $ \Theta_t\sigma_t = \strisoluks(u, v, \KernelOf(\psi_\Delta)t, \Omega) $ as defined in the algorithm
		\item $ \rightsquigarrow $ it suffices to show \[
		\NumLeaves(\Theta_t\sigma_t) \le k \cdot \Bigg(\frac{\abs{\Omega}}{k}\Bigg)^{c+1}
		\]
	\end{itemize}
\end{frame}

\begin{frame}{Time complexity analysis -- transitive case (continued)}
	\vspace{-4pt}\textbf{To show}: \[
	\NumLeaves(\Theta_t\sigma_t) \le k \cdot (\abs{\Omega}/k)^{c+1}
	\] \textbf{Proof}: The tree of recursive calls starting at $ \Theta_t\sigma_t $ will be (in the worst case) of the form:\begin{center}
		\begin{tikzpicture}[thick, scale=1]
			% vertices
			\node (root) {$ (\KernelOf(\psi_\Delta)t, \Omega) $};
			\node[right=.5 of root] (n1) {$ (\KernelOf(\psi_\Delta), \Omega) $};
			\node[right=.5 of n1] (nd1) {$ (\KernelOf(\psi_\Delta), \Delta_1) $};
			
			% first layer
			\node (n2) at ($ (root) + (-0.6, -1) $) {$ (\Gamma_1\sigma_1, \Delta_2 \cup \dots \cup \Delta_k) $};
			\node[right=.5 of n2] (n2gr) {$ (\Gamma_1, \Delta_2 \cup \dots \cup \Delta_k) $};
			\node[right=.5 of n2gr] (n2grd2) {$ (\Gamma_1, \Delta_2) $};
			
			% second layer
			\node[below=.5 of n2] (n3) {$ (\Gamma_2\sigma_2, \Delta_3 \cup \dots \cup \Delta_k) $};
			\node[right=.5 of n3] (n3gr) {$ (\Gamma_2, \Delta_3 \cup \dots \cup \Delta_k) $};
			\node[right=.5 of n3gr] (n3grd3) {$ (\Gamma_2, \Delta_3) $};
			
			% dots
			\node[below=-.1 of n3gr] (dots) {$ \vdots $};
			
			% last layer
			\node[below=.75 of n3] (nk) {$ (\Gamma_{k-1}\sigma_{k-1}, \Delta_k) $};
			\node[right=4.5 of nk] (nkgr) {$ (\Gamma_{k-1}, \Delta_k) $};
			
			% edges
			\draw[->] (root)--(n1);
			\draw[->] (n1)--(nd1);
			% first layer
			\draw[->] (n1)--(n2);
			\draw[->] (n2)--(n2gr);
			\draw[->] (n2gr)--(n2grd2);
			
			% second layer
			\draw[->] (n2gr)--(n3);
			\draw[->] (n3)--(n3gr);
			\draw[->] (n3gr)--(n3grd3);
			
			% last layer
			\draw[->] (nk)--(nkgr);
			
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (nd1.north east) -- (nkgr.south east) node[pos=0.7,left=-18pt,black,rotate=-90]{$ k $ nodes};
		\end{tikzpicture}
	\end{center}
	\vspace{-3pt}\begin{itemize}
		\item The window size at every step is $ \le \abs{\Omega}/k $
		\item $ \rightsquigarrow $ By IH, every end node has $ \le (\abs{\Omega}/k)^{c+1} $ leaves
		\item There are $ \le k $ such end nodes $ \rightsquigarrow $ the claim follows
	\end{itemize}
\end{frame}
\else
\begin{frame}{Time complexity analysis}
	\begin{claim}
		Let $ \NumLeaves $ be the number of leaves in the tree of recursive calls. Then \[
		\NumLeaves \le \sum_{\Gamma\cdot\omega \in \Omega/\Gamma} \abs{\Gamma\cdot\omega}^{c+1}
		\] where $ c $ is the constant of the Babai-Cameron-P\'{a}lfy theorem above.
	\end{claim}
	For reasons of time, we only prove this claim for the transitive case:
	
	\textbf{Sufficient to show}: \[
		\NumLeaves(\Theta_t\sigma_t) \le k \cdot (\abs{\Omega}/k)^{c+1}
	\]\vspace{-15pt}\begin{itemize}
		\item The tree of recursive calls starting at $ \Theta_t\sigma_t $ will contain at most $ k $ recursive calls
		\item Moreover, these calls are guaranteed to be in the intransitive case
		\item The window size at every subcall is $ \le \abs{\Omega}/k $
		\item $ \rightsquigarrow $ Claim follows by induction
	\end{itemize}
\end{frame}
\fi

\begin{frame}{Luks's algorithm for graph isomorphism}
	
	Above claim, together with the observation that the degree of every non-leaf recursion call tree node or its (non-leaf) child is $ \ge 3 $, yields:
	
	\begin{lemma}
		Luks's algorithm for $ \SI $ for $ \GammaD $-groups runs in polynomial time if $ d \le O(1) $.
	\end{lemma}
	
	By combining this result with the Babai-Luks reduction from $ \GI $ to $ \SI $ for $ \GammaD $-groups, we obtain:
	
	\begin{theorem}[Luks]
		$ \GI $ for graphs of maximum degree $ O(1) $ can be solved in polynomial time.
	\end{theorem}
\end{frame}

\end{document}
% \documentclass[handout]{beamer}
\documentclass{beamer}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usepackage{amsmath, amsthm, amsfonts, amssymb}
\usepackage{mathrsfs}

\usepackage{oubraces}
\usepackage{array}
\usepackage{varwidth}
\usepackage{array}

\input{tikz_config}

\usepackage[sanserif]{complexity}

% Algorithms
\usepackage[plain]{algorithm2e}
\SetKw{Continue}{continue}
\SetKwIF{If}{ElseIf}{Else}{if}{then}{else if}{else}{} % removes "end" at the end of if statements

\usetheme{Madrid}
\usecolortheme{default}

\title[Luks's algorithm for Graph Isomorphism]{Luks's algorithm for the Graph Isomorphism problem}
\author{Alexander Mayorov}
\institute[MPI-INF]{Max-Planck Institute for Informatics}

\input{defs}

%\AtBeginSection[]
%{
%	\begin{frame}
%		\frametitle{Table of Contents}
%		\tableofcontents[currentsection]
%	\end{frame}
%}

\begin{document}
	
\frame{\titlepage}

\section{Basics}

\begin{frame}{Graph Isomorphism Problem}
	
	% \textbf{Intuition}: Two graphs are called isomorphic whenever they are equal up to renaming of vertices.
	
	\begin{definition}[Graph isomorphism]
		Undirected graphs \( G_0 = (V_0, E_0) \) and \( G_1 = (V_1, E_1) \) are called \textbf{isomorphic} (denoted $ G_0 \cong G_1 $) if there exists a bijection $ \sigma : V_0 \to V_1 $ such that \[
		\{u,v\} \in E_0 \iff \{\sigma(u), \sigma(v)\} \in E_1
		\]
	\end{definition}

\newcommand{\graphA}{%
	\raisebox{-.5\height}{%
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (a1) at (0,0) {1};
			\node (a2) at (1.2,0) {2};
			\node (a3) at (1.2,1.2) {3};
			\node (a4) at (0,1.2) {4};
			\draw (a1)--(a2)--(a3)--(a4)--(a1);
		\end{tikzpicture}%
	}%
}

\newcommand{\graphB}{%
	\raisebox{-.5\height}{%
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (b1) at (0,0) {a};
			\node (b2) at (1.2,0) {b};
			\node (b3) at (1.2,1.2) {c};
			\node (b4) at (0,1.2) {d};
			\draw (b1)--(b3);
			\draw (b3)--(b4);
			\draw (b4)--(b2);
			\draw (b2)--(b1);
		\end{tikzpicture}%
	}%
}

\newcommand{\graphC}{%
	\raisebox{-.5\height}{%
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (c1) at (0,0) {$ \alpha $};
			\node (c2) at (1.2,0) {$ \beta $};
			\node (c3) at (2.4,0) {$ \gamma $};
			\node (c4) at (1.2,1.2) {$ \delta $};
			\draw (c1)--(c2)--(c3);
			\draw (c2)--(c4);
		\end{tikzpicture}%
	}%
}

\begin{example}
	\begin{center}
		\renewcommand{\arraystretch}{1.5} % row height
		\begin{tabular}{c c c c c}
			\graphA & $\cong$ & \graphB & $\not\cong$ & \graphC
		\end{tabular}
	\end{center}
\end{example}

\begin{definition}[Graph Isomorphism Problem ($ \GI $)]
	\textbf{Given}: Undirected graphs $ G_0 = (V_0, E_0) $, $ G_1 = (V_1, E_1) $
	
	\textbf{Decide}: Is $ G_0 \cong G_1 $?
\end{definition}
\end{frame}

\begin{frame}{$ \GI $ has a very special status (for all we know)}
	\begin{center}
		\begin{tikzpicture}[scale=1.0, every node/.style={font=\large}]
			% Parameters
			\def\semiMajorAxis{5.5}
			\def\semiMinorAxis{3.5}
			\def\npSubclassLabelOffset{-1.5}
			\def\npSubclassExampleOffset{-1}
			\def\pYCoord{-2.0}
			\def\npiYCoord{0.0}
			\def\npcYCoord{2.0}
			
			\path[use as bounding box] (-6,-3.2) rectangle (6,3.2);
			
			% NP ellipse (main region)
			\path[name path=ellipse] (0,0) ellipse ({\semiMajorAxis} and {\semiMinorAxis});
			\draw[fill=blue!10, thick, name path global=NP] (0,0) ellipse ({\semiMajorAxis} and {\semiMinorAxis});
			\node at (4.7,2.6) {\textbf{NP}};
			
			% Define y positions of boundaries
			\def\yP{-1.0}
			\def\yC{1.0}
			
			% Define horizontal lines for boundaries
			\path[name path=Pline] (-\semiMajorAxis-1,\yP) -- (\semiMajorAxis+1,\yP);
			\path[name path=Cline] (-\semiMajorAxis-1,\yC) -- (\semiMajorAxis+1,\yC);
			
			% Find intersection points
			\path[name intersections={of=ellipse and Pline, by={PL, PR}}];
			\path[name intersections={of=ellipse and Cline, by={CL, CR}}];
			
			% Draw boundary lines exactly clipped to ellipse
			\draw[dashed, thick] (PL) -- (PR);
			\draw[dashed, thick] (CL) -- (CR);
			
			% Region labels
			\node[font=\bfseries, OliveGreenZB!80!black, anchor=east] at (\npSubclassLabelOffset,\pYCoord) {P};
			\node[font=\bfseries, anchor=east] at (\npSubclassLabelOffset,\npiYCoord) {NP-intermediate};
			\node[font=\bfseries, DarkRedZB, anchor=east] at (\npSubclassLabelOffset,\npcYCoord) {NP-complete};
			
			% Example problems (directly inside regions)
			% NPC
			\node[anchor=west] at (\npSubclassExampleOffset,\npcYCoord + 0.5) {SAT, Clique, Coloring,};
			\node[anchor=west] at (\npSubclassExampleOffset,\npcYCoord) {Vertex-Cover, Set-Cover,};
			\node[anchor=west] at (\npSubclassExampleOffset,\npcYCoord - 0.5) {Hitting-Set, Subset-Sum, $ \dots $};
			% NPI
			\node[MagentaZB, anchor=west] (ginode) at (\npSubclassExampleOffset,\npiYCoord) {Graph Isomorphism ($ \GI $)};
			\node[anchor=west] at ($ (ginode.east |- 0,\npiYCoord) + (-0.25,-0.1) $) {, $\dots$};
			% P
			\node[anchor=west] at (\npSubclassExampleOffset,\pYCoord + 0.5) {2-SAT, Edge-Cover, 2-Coloring,};
			\node[anchor=west] at (\npSubclassExampleOffset,\pYCoord) {Primes, Maximal-Matching,};
			\node[anchor=west] at (\npSubclassExampleOffset,\pYCoord - 0.5) {Shortest-Path, $ \dots $};
			
		\end{tikzpicture}
	\end{center}
	\textbf{Warning}: this diagram assumes $ \PH $ does not collapse (long-standing open question) and $ \GI \notin \P $ (open).
\end{frame}

\begin{frame}{Solutions to $ \GI $ have a very nice structure}
	
	\begin{itemize}
		\item Unlike with $ \NP $-complete problems, the space of solutions to $ \GI $ has a lot of structure!
		\item To see this, consider first the isomorphisms between a graph and itself (a.k.a. automorphisms)
	\end{itemize}
	\textbf{Example}: The automorphism group of
	\begin{center}
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			% nodes
			\node (v1) at (0,0) {1};
			\node[left=1.5 of v1] (v2) {2};
			\node[right=1.5 of v1] (v3) {3};
			\node[above=1 of v2] (v4) {4};
			\node[above=1 of v3] (v5) {5};
			\node (v6) at ($ (v4)!0.5!(v2) - (2,0) $) {6};
			\node (v7) at ($ (v3)!0.5!(v5) + (2,0) $) {7};
			\node[above=1 of v6] (v8) {8};
			\node[above=1 of v7] (v9) {9};
			
			% edges
			\draw (v1)--(v2) (v1)--(v4);
			\draw (v1)--(v3) (v1)--(v5);
			\draw (v2)--(v4) (v3)--(v5);
			\draw (v4)--(v6) (v4)--(v8);
			\draw (v5)--(v7) (v5)--(v9);
		\end{tikzpicture}
	\end{center}
	is\[
		\Aut(G) = \gen{(6\,8), (7\,9), (2\,3)(4\,5)(6\,7)(8\,9)} \le S_9
	\]
\end{frame}

\input{four_vertex_graph_iso_classes}

\begin{frame}{Automorphism groups as stabilizers}
	\textbf{Observation}: $ \Aut(G) $ is the stabilizer of $ G $ in the vertex renaming action of $ \Sym(V(G)) $ on the set of all graphs with vertices $ V(G) $.
	
	\textbf{Visualization for $ V(G) = \{1,2,3,4\} $}:\begin{center}
		\setlength{\extrarowheight}{3pt}
		\begin{columns}
			\begin{column}{0.4\textwidth}
				\begin{tabular}{>{\centering\arraybackslash}m{2cm} >{\centering\arraybackslash}m{2.5cm}}
					Orbit&Stabilizer of \textcolor{TurquoiseZB}{$ G $}\\
					\hline\vspace{1pt}\orbitOne&$ S_4 $\\
					\hline\vspace{1pt}\orbitTwo&$ S_4 $\\
					\hline\vspace{1pt}\orbitThree&$ \gen{(1\,3)} $\\
					\hline\vspace{1pt}\orbitFour&$ \gen{(1\,3)} $\\
					\hline\vspace{1pt}\orbitFive&$ \gen{(1\,2\,3\,4),(1\,3)} $\\
					\hline\vspace{1pt}\orbitSix&$ \gen{(1\,2\,3\,4),(1\,3)} $
				\end{tabular}
			\end{column}
			\begin{column}{0.4\textwidth}
				\begin{tabular}{>{\centering\arraybackslash}m{2cm} >{\centering\arraybackslash}m{2.5cm}}
					Orbit&Stabilizer of \textcolor{TurquoiseZB}{$ G $}\\
					\hline\vspace{1pt}\orbitSeven&$ \gen{(1\,4)(2\,3)} $\\
					\hline\vspace{1pt}\orbitEight&$ S_3 $\\
					\hline\vspace{1pt}\orbitNine&$ S_3 $\\
					\hline\vspace{1pt}\orbitTen&$ \gen{(1\,2),(3\,4)} $\\
					\hline\vspace{1pt}\orbitEleven&$ \gen{(1\,2),(3\,4)} $
				\end{tabular}
			\end{column}
		\end{columns}
	\end{center}
\end{frame}

\begin{frame}{Solutions to $ \GI $ are sets of cosets}
	\begin{itemize}
		\item Let $ \cdot $ denote the vertex renaming action of $ \Sym(V(G)) $ on the set of all graphs with vertices $ V(G) $
		\item Fix one of the input graphs $ G_0 $
		\item $ \rightsquigarrow $ Space of solutions to $ \GI $ is \[
			\{G_1 \mid G_1 \cong G_0\} = S_n \cdot G_0
		\] the orbit of $ G_0 $
		\item Since $ \Aut(G_0) = \Stab(G_0) $ and \begin{align*}
			\varphi : S_n/\Stab(G_0) &\rightarrow S_n \cdot G_0 \\
			\sigma\Stab(G_0) &\mapsto \sigma \cdot G_0
		\end{align*} is a bijection, we get \[
			\{G_1 \mid G_1 \cong G_0\} \overset{1:1}{\longleftrightarrow} S_n/\Aut(G_0)
		\]
		\item $ \rightsquigarrow $ Solutions to $ \GI $ are sets of cosets!
	\end{itemize}
\end{frame}

\begin{frame}{High-level overview}
	We will show how to solve (a fragment of) $ \GI $ via an intermediate problem:
	\begin{center}
		\begin{tikzpicture}[thick]
			% problems
			\node [block] (gi) {\blocktext{Graph Isomorphism Problem (GI)}};
			\node [block, below=3em of gi] (si) {\blocktext{String Isomorphism Problem (SI)}};
			
			% algorithms
			\node [block, below=3em of si] (algo) {Luks's algorithm};
			
			% reductions
			\draw[->, LightBlueZB] (gi) --node[midway, right]{reduce} (si);
			\draw[->, LightBlueZB] (si) --node[midway, right]{solve} (algo);
			
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt, mirror}] (gi.north west) -- (si.south west) node[pos=0.5,left=10pt,black]{\blocktext{Encode graphs into strings, introduce group}};
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (si.north east) -- (algo.south east) node[pos=0.5,right=10pt,black]{\blocktext{Use group-theoretic machinery}};
		\end{tikzpicture}
	\end{center}
\end{frame}

\section{Luks's algorithm}

\begin{frame}{Strings and permutations}
	
	A string is a mapping $ u : D \rightarrow \Sigma $ where $ D, \Sigma $ are fixed finite sets.
	
	\textbf{Intuition}: Elements of $ D $ are markers of positions, and values of $ u $ are characters at the corresponding positions.
	
	\begin{definition}[Permutation applied to a string]
		For $ \sigma \in \Sym(D) $, define string $ u^\sigma $ to be \begin{align*}
			u^\sigma : D &\rightarrow \Sigma \\
			\omega &\mapsto u (\sigma^{-1}(\omega))
		\end{align*}
	\end{definition}

	\begin{example}
		Let $ D := \{1, 2, 3\} $ and $ \Sigma := \{a, b, c\} $. Then \[
			abc^{()} = abc \qquad abc^{(1\,2\,3)} = cab \qquad abc^{(1\,3\,2)} = bca
		\] where $ abc $ denotes mapping $ 1 \mapsto a $, $ 2 \mapsto b $, $ 3 \mapsto c $.
	\end{example}

\end{frame}

\begin{frame}{String Isomorphism Problem}
	
	Let $ u, v $ be strings and $ \Gamma \le \Sym(D) $. Define \[
		\Iso_{\Gamma}(u, v) := \{\gamma \in \Gamma \mid u^\gamma = v\}
	\] We say that $ u $ is $ \Gamma $-isomorphic to $ v $ and write $ u \cong_{\Gamma} v $ whenever $ \Iso_{\Gamma}(u, v) \neq \varnothing $.
	
	\begin{definition}[String Isomorphism Problem ($ \SI $)]
		\textbf{Given}: \begin{itemize}
			\item Strings $ u, v $
			\item Group $ \Gamma \le \Sym(D) $ (represented as generating set)
		\end{itemize}
	
		\textbf{Decide}: Is $ u \cong_\Gamma v $?
	\end{definition}

	\begin{example}
		Consider $ \Gamma := \gen{(1,\dots,n)} \le S_n = \Sym(D) $ for $ D := \{1, \dots, n\} $.
		
		Then $ u \cong_\Gamma v $ if and only if $ u $ and $ v $ are conjugate words.
	\end{example}
\end{frame}

\newcommand{\giToSiReductionGraphZero}{
	\raisebox{-.5\height}{
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (a1) at (0,1.2) {1};
			\node (a2) at (1.2,1.2) {2};
			\node (a3) at (0,0) {3};
			\node (a4) at (1.2,0) {4};
			\draw (a3)--(a1)--(a2)--(a3)--(a4);
		\end{tikzpicture}
	}
}

\newcommand{\giToSiReductionGraphOne}{
	\raisebox{-.5\height}{
		\begin{tikzpicture}[every node/.style={circle, draw, fill=gray!10, inner sep=1pt, minimum size=18pt}, scale=0.8]
			\node (b1) at (0,1.2) {3};
			\node (b2) at (1.2,1.2) {2};
			\node (b3) at (0,0) {1};
			\node (b4) at (1.2,0) {4};
			\draw (b3)--(b1)--(b2)--(b3)--(b4);
		\end{tikzpicture}
	}
}

% The essence of the above reduction is to ``lift`` isomorphism test from the level of nodes to the level of edges.

\begin{frame}{Towards a reduction from $ \GI $ to $ \SI $}
	\only<1|handout:1>{We reduce the following $ \GI $ instance to $ \SI $:\begin{center}
		\renewcommand{\arraystretch}{1.5} % row height
		\begin{tabular}{c c c}
			$ G_0 $ && $ G_1 $\\
			\giToSiReductionGraphZero & $\overset{?}{\cong}$ & \giToSiReductionGraphOne
		\end{tabular}
	\end{center}}
	\only<1|handout:1>{\textbf{Idea}: encode existence of edges into a string:}
	\only<1-2|handout:1-2>{\begin{center}
		\begin{tabular}{c|c c c c c c}
			$ \omega \in \Omega $ & $ \{1, 2\} $ & $ \{1, 3\} $ & $ \{1, 4\} $ & $ \{2, 3\} $ & $ \{2, 4\} $ & $ \{3, 4\} $\\
			\hline
			$ u_0(\omega) $ & $ 1 $ & $ 1 $ & $ 0 $ & $ 1 $ & $ 0 $ & $ 1 $\\
			$ u_1(\omega) $ & $ 1 $ & $ 1 $ & $ 1 $ & $ 1 $ & $ 0 $ & $ 0 $
		\end{tabular}
	\end{center}}
	\only<2-3|handout:2-3>{This $ \SI $ instance has the following solution:\begin{center}
		\begin{tikzpicture}[thick]
			
			% labels
			\node (l12) {$\{1,2\}$};
			\node[right=.5em of l12] (l13) {$\{1,3\}$};
			\node[right=.5em of l13] (l14) {$\{1,4\}$};
			\node[right=.5em of l14] (l23) {$\{2,3\}$};
			\node[right=.5em of l23] (l24) {$\{2,4\}$};
			\node[right=.5em of l24] (l34) {$\{3,4\}$};
			
			% u_0
			\node[below=.5em of l12] (u0at12) {$ 1 $};
			\node[below=.5em of l13] (u0at13) {$ 1 $};
			\node[below=.5em of l14] (u0at14) {$ 0 $};
			\node[below=.5em of l23] (u0at23) {$ 1 $};
			\node[below=.5em of l24] (u0at24) {$ 0 $};
			\node[below=.5em of l34] (u0at34) {$ 1 $};
			
			\node[left=2em of u0at12] {$ u_0 $};
			
			% u_1
			\node[below=4em of u0at12] (u1at12) {$ 1 $};
			\node[below=4em of u0at13] (u1at13) {$ 1 $};
			\node[below=4em of u0at14] (u1at14) {$ 1 $};
			\node[below=4em of u0at23] (u1at23) {$ 1 $};
			\node[below=4em of u0at24] (u1at24) {$ 0 $};
			\node[below=4em of u0at34] (u1at34) {$ 0 $};
			
			\node[left=2em of u1at12] {$ u_1 $};
			
			% edges from v to u_1
			\draw[->, LightBlueZB] (u0at12.south) -- (u1at23.north);
			\draw[->, LightBlueZB] (u0at13.south) -- (u1at13.north);
			\draw[->, LightBlueZB] (u0at14.south) -- (u1at34.north);
			\draw[->, LightBlueZB] (u0at23.south) -- (u1at12.north);
			\draw[->, LightBlueZB] (u0at24.south) -- (u1at24.north);
			\draw[->, LightBlueZB] (u0at34.south) -- (u1at14.north);
			
		\end{tikzpicture}
	\end{center}}
	\only<3|handout:3>{This solution shows the existence of the isomorphism\begin{center}
			\renewcommand{\arraystretch}{1.5} % row height
			\begin{tabular}{c c c}
				\giToSiReductionGraphZero & \begin{tikzpicture}[thick]
					\draw[->] (0,0) --node[midway, above]{$ \sigma := \textcolor{LightBlueZB}{(1\,3)} $} (3,0);
				\end{tikzpicture} & \giToSiReductionGraphOne
			\end{tabular}
	\end{center}}
\end{frame}

\begin{frame}{Without constraints on $ \SI $ we don't have soundness}
	\textbf{\textcolor{DarkRedZB}{Problem}}: this $ \SI $ instance also has the following solution:\begin{center}
		\begin{tikzpicture}[thick]
			
			% labels
			\node (l12) {$\{1,2\}$};
			\node[right=.5em of l12] (l13) {$\{1,3\}$};
			\node[right=.5em of l13] (l14) {$\{1,4\}$};
			\node[right=.5em of l14] (l23) {$\{2,3\}$};
			\node[right=.5em of l23] (l24) {$\{2,4\}$};
			\node[right=.5em of l24] (l34) {$\{3,4\}$};
			
			% u_0
			\node[below=.5em of l12] (u0at12) {$ 1 $};
			\node[below=.5em of l13] (u0at13) {$ 1 $};
			\node[below=.5em of l14] (u0at14) {$ 0 $};
			\node[below=.5em of l23] (u0at23) {$ 1 $};
			\node[below=.5em of l24] (u0at24) {$ 0 $};
			\node[below=.5em of l34] (u0at34) {$ 1 $};
			
			\node[left=2em of u0at12] {$ u_0 $};
			
			% u_1
			\node[below=3em of u0at12] (u1at12) {$ 1 $};
			\node[below=3em of u0at13] (u1at13) {$ 1 $};
			\node[below=3em of u0at14] (u1at14) {$ 1 $};
			\node[below=3em of u0at23] (u1at23) {$ 1 $};
			\node[below=3em of u0at24] (u1at24) {$ 0 $};
			\node[below=3em of u0at34] (u1at34) {$ 0 $};
			
			\node[left=2em of u1at12] {$ u_1 $};
			
			% edges from u_0 to u_1
			\draw[->, MagentaZB] (u0at12.south) -- (u1at12.north);
			\draw[->, MagentaZB] (u0at13.south) -- (u1at13.north);
			\draw[->, MagentaZB] (u0at14.south) -- (u1at24.north);
			\draw[->, MagentaZB] (u0at23.south) -- (u1at14.north);
			\draw[->, MagentaZB] (u0at24.south) -- (u1at34.north);
			\draw[->, MagentaZB] (u0at34.south) -- (u1at23.north);
			
		\end{tikzpicture}
	\end{center}\begin{itemize}
		\item This solution does not correspond to any graph isomorphism
		\item $ \rightsquigarrow $ The reduction is complete but not sound!
	\end{itemize}

	\textbf{\textcolor{OliveGreenZB}{Solution}}: Define $ \Gamma $ to contain exactly those permutations that are induced by permutations on vertices.
\end{frame}

%\textbf{Proof idea}: encode each graph into a string such that relabeling vertices corresponds to permuting characters of the string.
\begin{frame}{$ \GI $ reduces to $ \SI $ efficiently}
	\vspace{-4pt}\begin{theorem}
		$ \GI \le_m^p \SI $
	\end{theorem}\vspace{-4pt}
	\begin{proof}
		W.l.o.g. assume $ V_0 = V_1 = \{1, \dots, n\} $. Set $ \Sigma := \{0, 1\} $ and $ D := \{\{i, j\} \mid 1 \le i < j \le n\} $. For $ b \in \{0, 1\} $ let $ u_b $ be a string defined by \[
			u_b(\{i, j\}) = 1 \iff \{i, j\} \in E_b
		\] Then \[
			G_0 \cong G_1 \iff u_0 \cong_{\ImageOf(\varphi)} u_1
		\] where $ \varphi : S_n \rightarrow \Sym(\Omega) $ is the embedding homomorphism \[
			\varphi(\sigma) := \Big(\{i, j\} \mapsto \{\sigma(i), \sigma(j)\}\Big)
		\] Therefore, $ \ImageOf(\psi) = \gen{\varphi((1\,2)), \varphi((1\,\dots\,n))} $ and the result follows.
	\end{proof}
\end{frame}

\begin{frame}{$ \GI $ for bounded-degree graphs}
	From this point we: \begin{itemize}
		\item assume that the input graphs to $ \GI $ have maximum degree $ \le d $
		\item assume that $ d \le O(1) $
		\item study the complexity of $ \GI $ in this setting
	\end{itemize}
	
	General idea: \begin{itemize}
		\item Find some structure in $ \Aut(G) $ for bounded-degree graphs
		\item Exploit this structure to obtain a fast algorithm
	\end{itemize}
\end{frame}

\begin{frame}{Groups and their composition factors}
	\vspace{-5pt}\begin{definition}
		Let $ \Gamma $ be a finite group. A \textit{subnormal series} of $ \Gamma $ is a sequence \[
		\{\id\} \trianglelefteq \Gamma_1 \trianglelefteq \Gamma_2 \trianglelefteq \dots \trianglelefteq \Gamma_k = \Gamma
		\] where $ \Gamma_1, \dots, \Gamma_k $ are groups. A subnormal series is a \textit{composition series} of $ \Gamma $ if it is strictly increasing and every $ \Gamma_i/\Gamma_{i-1} $ is simple (factor groups $ \Gamma_i/\Gamma_{i-1} $ are called \textit{composition factors}).
	\end{definition}
	\vspace{-5pt}\begin{theorem}[Jordan-H{\"o}lder]
		Every finite group can be decomposed uniquely into its composition factors.
	\end{theorem}
	\vspace{-5pt}\begin{example}
		The composition series of $ S_n $ is $ \{\id\} \trianglelefteq A_n \trianglelefteq S_n $. It corresponds to the decomposition $ S_n \cong \Z_2 \rtimes A_n $.
	\end{example}
\end{frame}

\begin{frame}{$ \Gamma_d $-groups}
	\begin{definition}[Luks]
		A finite group $ \Gamma $ is a $ \Gamma_d $-group (notation: $ \Gamma \in \Gamma_d $) if every composition factor of $ \Gamma $ is isomorphic to some subgroup of $ S_d $.
	\end{definition}

	The class $ \Gamma_d $ has a lot of nice properties, for example:
	
	\begin{lemma}[$ \Gamma_d $ closed under subgroups]
		Let $ H $ be a finite $ \Gamma_d $-group and let $ H' \le H $. Then $ H' \in \Gamma_d $.
	\end{lemma}

	\begin{lemma}
		Let $ H $ be finite group and $ N \trianglelefteq H $. Then \[
			H \in \Gamma_d \iff N \in \Gamma_d \text{ and } H/N \in \Gamma_d
		\]
	\end{lemma}
\end{frame}

\begin{frame}{Automorphism groups of bounded-degree graphs}
	
	\begin{itemize}
		\item It would be nice if $ \Aut(G) \in \Gamma_d $ was true for graphs $ G $ of maximum degree $ \le d $
		\item However, this is not the case:
	\end{itemize}
	\begin{theorem}[Frucht]
		For any finite group $ \Gamma $ there exists a 3-regular graph $ G $ such that $ \Aut(G) \cong \Gamma $
	\end{theorem}
	\begin{itemize}
		\item Fortunately, we can circumvent the problem by fixing a vertex $ v $ and considering $ \Aut(G, v) := \{\sigma \in \Aut(G) \mid \sigma(v) = v\} \le \Aut(G) $.
	\end{itemize}
	\begin{theorem}[Luks]
		Let $ d \ge 2 $. For any connected graph $ G $ of maximum degree at most $ d $ and $ v \in V(G) $ it holds that $ \Aut(G, v) \in \Gamma_d $.
	\end{theorem}
\end{frame}

\begin{frame}{Proof of Luks's theorem}
	\begin{columns}
		\begin{column}{0.65\textwidth}
			\input{luks_autgammad_thm_proof_rdef}
		\end{column}
		\begin{column}{0.35\textwidth}  %%<--- here
			Let $ R_i $ be a graph with \textbf{vertices}:
			
			$ w \in V(G) $ such that $ d_G(v, w) \le i $ 
			
			\textbf{edges}:
			
			$ \{w_1, w_2\} \in E(G) $ such that $ d_G(v, w_1) \le i - 1 $ and $ d_G(v, w_2) \le i $
			
			\vspace{5pt}Note that $ \exists i\ R_i = G $
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}{Proof of Luks's theorem (continued)}
	We prove $ \Aut(R_i, v) \in \Gamma_d $ by induction on $ i $.
	
	\textbf{Base case} ($ i = 0 $): $ \Aut(R_0, v) = \{\id\} \in \Gamma_d $
	
	\textbf{Inductive step}:\begin{itemize}
		\item Note that $ G[V(R_{i-1})] $ is equal to $ R_{i-1} $ up to possibly additional edges between vertices at distance exactly $ i-1 $ from $ v $
		\item $ \rightsquigarrow $ By IH, $ \Aut(G[V(R_{i-1})], v) \le \Aut(R_{i-1}, v) \in \Gamma_d $
		\item Since $ \Gamma_d $ is closed under subgroups, $ \Aut(G[V(R_{i-1})], v) \in \Gamma_d $
		\item Since $ \sigma \in \Aut(R_i, v) $ must send vertices in $ V(R_{i-1}) $ to $ V(R_{i-1}) $, \begin{align*}
			\varphi_i : \Aut(R_i, v) &\rightarrow \Aut(G[V(R_{i-1})], v)\\
			\sigma &\mapsto \sigma\restrict{V(R_{i-1})}
		\end{align*} is well-defined
		\item By FHT, \[
		\Aut(R_i, v)/\KernelOf(\varphi_i) \cong \ImageOf(\varphi_i) = \Aut(G[V(R_{i-1})], v) \in \Gamma_d
		\]
		\item By the above lemma, it is sufficient to prove $ \KernelOf(\varphi_i) \in \Gamma_d $
	\end{itemize}
\end{frame}

\begin{frame}{Proof of Luks's theorem (continued)}
	\begin{columns}
		\begin{column}{0.35\textwidth}
			\input{uks_autgammad_thm_proof_im1toi}
		\end{column}
		\begin{column}{0.65\textwidth}
			\textbf{To show}: $ \KernelOf(\varphi_i) \in \Gamma_d $
			\begin{itemize}
				\item $ \KernelOf(\varphi_i) $ consists of exactly those $ \sigma \in \Aut(G[V(R_{i-1})], v) $ such that $ \sigma(u) = u\ \forall u \in V(R_{i-1}) $.
				\item Let $ W $ be nodes of $ R_i $ that are not in $ R_{i-1} $
				\item $ W $ is an independent set in $ R_i $
				% \item $ \rightsquigarrow $ Agreeing on $ N(w) $ is an equivalence relation
				\item $ \rightsquigarrow $ If $ \sigma(w) = w' $ for some $ \sigma \in \KernelOf(\varphi_i) $ then $ w, w' \in W $ and $ N_{R_i}(w) = N_{R_i}(w') $
				%\pause
				\item Since every node has degree $ \le d $, every $ w \in W $ can agree with $ \le d $ other $ w' \in W $ on the neighborhood
				\item $ \rightsquigarrow \KernelOf(\varphi_i) $ isomorphic to a subgroup of $ S_d^m $
				\item Since $ S_d^m \in \Gamma_d $ and $ \Gamma_d $ is closed under subgroups, the result follows.
			\end{itemize}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}{Effectivizing Luks's theorem}
	The level-driven construction in the proof of Luks's theorem can be turned into an algorithm for $ \GI $:
	
	\begin{theorem}[Babai, Luks]
		There is a polynomial-time Turing reduction from $ \GI $ for graphs of maximum degree $ d $ to $ \SI $ for $ \Gamma_d $-groups.
	\end{theorem}
\end{frame}

\begin{frame}{Proof of Babai-Luks theorem}
	\begin{columns}
		\begin{column}{0.35\textwidth}
			\input{babai_luks_reduction_proof}
		\end{column}
		\begin{column}{0.65\textwidth}
			\begin{itemize}
				\item W.l.o.g. assume that $ G_0 $ and $ G_1 $ are both connected
				\item TODO
			\end{itemize}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}{Introduction to blocks of group actions}
	We start with an example:
	\begin{center}
		\begin{columns}
			\begin{column}{0.4\textwidth}
				\begin{tikzpicture}[scale=1, thick]
					
					% hexagon vertices
					\coordinate (v1) at ({90 - (0)*60}:2);
					\coordinate (v2) at ({90 - (1)*60}:2);
					\coordinate (v3) at ({90 - (2)*60}:2);
					\coordinate (v4) at ({90 - (3)*60}:2);
					\coordinate (v5) at ({90 - (4)*60}:2);
					\coordinate (v6) at ({90 - (5)*60}:2);
					
					% hexagon
					\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
					
					% labels
					\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
					\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
					\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
					\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
					\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
					\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
					
					% 60 degree rotation arrows
					\draw[->, bend left=20, OliveGreenZB] (l1) to node[midway, above] {$ r $} (l2);
					\draw[->, bend left=20, OliveGreenZB] (l2) to (l3);
					\draw[->, bend left=20, OliveGreenZB] (l3) to (l4);
					\draw[->, bend left=20, OliveGreenZB] (l4) to (l5);
					\draw[->, bend left=20, OliveGreenZB] (l5) to (l6);
					\draw[->, bend left=20, OliveGreenZB] (l6) to (l1);
					
					% flip around 1--4 axis
					\draw[<->, LightBlueZB] ($ (l6.east) + (1,0) $) to node[midway, above] {$ f $} ($ (l2.west) - (1,0) $);
					\draw[<->, LightBlueZB] ($ (l5.east) + (1,0) $) to ($ (l3.west) - (1,0) $);
					\draw[<->, LightBlueZB] (l1) .. controls +(-.4, .7) and +(.4, .7) .. (l1);
					\draw[<->, LightBlueZB] (l4) .. controls +(-.4, -.7) and +(.4, -.7) .. (l4);
				\end{tikzpicture}
			\end{column}
			\begin{column}{0.5\textwidth}
				\begin{itemize}
					\item Let $ \Gamma \le S_6 $ be the symmetry group of the hexagon
					\item $ \Gamma = \gen{\textcolor{OliveGreenZB}{r}, \textcolor{LightBlueZB}{f}} $ where $ \textcolor{OliveGreenZB}{r} := \textcolor{OliveGreenZB}{(1\,2\,3\,4\,5\,6)} $ and $ \textcolor{LightBlueZB}{f} := \textcolor{LightBlueZB}{(6\,2)(5\,3)} $
					\item $ \Gamma $ acts on $ \Omega := \{1,2,3,4,5,6\} $ via $ \gamma \cdot \omega := \gamma(\omega) $
				\end{itemize}
			\end{column}
		\end{columns}
	\end{center}
\end{frame}

\begin{frame}{Some subsets of $ \Omega $ only permute or translate}
	\textbf{Observation}: for any $ \gamma \in \Gamma $ we have
	\begin{center}
		\begin{tikzpicture}[scale=1, thick]
			\begin{scope}[shift={(-2.75,0)}]
				% hexagon vertices
				\coordinate (v1) at ({90 - (0)*60}:2);
				\coordinate (v2) at ({90 - (1)*60}:2);
				\coordinate (v3) at ({90 - (2)*60}:2);
				\coordinate (v4) at ({90 - (3)*60}:2);
				\coordinate (v5) at ({90 - (4)*60}:2);
				\coordinate (v6) at ({90 - (5)*60}:2);
				
				% hexagon
				\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
				
				% labels
				\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
				\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
				\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
				\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
				\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
				\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
				
				% 60 degree rotation arrows
				\draw[->, bend left=20, OliveGreenZB] (l1) to (l2);
				\draw[->, bend left=20, OliveGreenZB] (l2) to (l3);
				\draw[->, bend left=20, OliveGreenZB] (l3) to (l4);
				\draw[->, bend left=20, OliveGreenZB] (l4) to (l5);
				\draw[->, bend left=20, OliveGreenZB] (l5) to (l6);
				\draw[->, bend left=20, OliveGreenZB] (l6) to (l1);
				
				% flip around 1--4 axis
				\draw[dashed, LightBlueZB] (v1) -- (v4);
				\draw[dashed, LightBlueZB] ($ (v1)!0.5!(v2) $) -- ($ (v4)!0.5!(v5) $);
				\draw[dashed, LightBlueZB] (v2) -- (v5);
				\draw[dashed, LightBlueZB] ($ (v2)!0.5!(v3) $) -- ($ (v5)!0.5!(v6) $);
				\draw[dashed, LightBlueZB] (v3) -- (v6);
				\draw[dashed, LightBlueZB] ($ (v3)!0.5!(v4) $) -- ($ (v6)!0.5!(v1) $);
				
				% block visualization
				\draw[very thick, red!80] (v4)--(v6)--(v2)--cycle;
				\filldraw[red!80] (v4) circle (3pt);
				\filldraw[red!80] (v6) circle (3pt);
				\filldraw[red!80] (v2) circle (3pt);
				
				\node[below=-.1 of l4] (lg1) {$ \gamma \cdot \{2,4,6\} = \{2,4,6\} $};
				\node[below=-.15 of lg1] (lg2) {\textbf{or}};
				\node[below=-.15 of lg2] {$ \gamma \cdot \{2,4,6\} = \{1,3,5\} $};
			\end{scope}
			\begin{scope}[shift={(2.75,0)}]
				% hexagon vertices
				\coordinate (v1) at ({90 - (0)*60}:2);
				\coordinate (v2) at ({90 - (1)*60}:2);
				\coordinate (v3) at ({90 - (2)*60}:2);
				\coordinate (v4) at ({90 - (3)*60}:2);
				\coordinate (v5) at ({90 - (4)*60}:2);
				\coordinate (v6) at ({90 - (5)*60}:2);
				
				% hexagon
				\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
				
				% labels
				\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
				\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
				\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
				\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
				\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
				\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
				
				% 60 degree rotation arrows
				\draw[->, bend left=20, OliveGreenZB] (l1) to (l2);
				\draw[->, bend left=20, OliveGreenZB] (l2) to (l3);
				\draw[->, bend left=20, OliveGreenZB] (l3) to (l4);
				\draw[->, bend left=20, OliveGreenZB] (l4) to (l5);
				\draw[->, bend left=20, OliveGreenZB] (l5) to (l6);
				\draw[->, bend left=20, OliveGreenZB] (l6) to (l1);
				
				% flip symmetries
				\draw[dashed, LightBlueZB] (v1) -- (v4);
				\draw[dashed, LightBlueZB] ($ (v1)!0.5!(v2) $) -- ($ (v4)!0.5!(v5) $);
				\draw[dashed, LightBlueZB] (v2) -- (v5);
				\draw[dashed, LightBlueZB] ($ (v2)!0.5!(v3) $) -- ($ (v5)!0.5!(v6) $);
				\draw[dashed, LightBlueZB] (v3) -- (v6);
				\draw[dashed, LightBlueZB] ($ (v3)!0.5!(v4) $) -- ($ (v6)!0.5!(v1) $);
				
				% block visualization
				\draw[very thick, red!80] (v1)--(v4);
				\filldraw[red!80] (v1) circle (3pt);
				\filldraw[red!80] (v4) circle (3pt);
				
				\node[below=-.1 of l4] (rg1) {$ \gamma \cdot \{1,4\} = \{1,4\} $};
				\node[below=-.15 of rg1] (rg2) {\textbf{or}};
				\node[below=-.15 of rg2] (rg3) {$ \gamma \cdot \{1,4\} = \{2,5\} $};
				\node[below=-.15 of rg3] (rg4) {\textbf{or}};
				\node[below=-.15 of rg4] {$ \gamma \cdot \{1,4\} = \{3,6\} $};
			\end{scope}
		\end{tikzpicture}
	\end{center}
\end{frame}

\begin{frame}{Not all subsets have this nice behavior}
	Consider $ \{1, 3\} \subseteq \Omega $.
	\begin{center}
		\begin{tikzpicture}[scale=1, thick]
			\begin{scope}[shift={(-2.75,0)}]
				% hexagon vertices
				\coordinate (v1) at ({90 - (0)*60}:2);
				\coordinate (v2) at ({90 - (1)*60}:2);
				\coordinate (v3) at ({90 - (2)*60}:2);
				\coordinate (v4) at ({90 - (3)*60}:2);
				\coordinate (v5) at ({90 - (4)*60}:2);
				\coordinate (v6) at ({90 - (5)*60}:2);
				
				% hexagon
				\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
				
				% labels
				\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
				\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
				\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
				\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
				\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
				\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
				
				% flip around 1--4 axis
				\draw[dashed, LightBlueZB] (v1) -- (v4);
				
				% block failure visualization
				\draw[very thick, red!80] (v1)--(v3);
				\filldraw[red!80] (v1) circle (3pt);
				\filldraw[red!80] (v3) circle (3pt);
			\end{scope}
			\begin{scope}[shift={(2.75,0)}]
				% hexagon vertices
				\coordinate (v1) at ({90 - (0)*60}:2);
				\coordinate (v2) at ({90 - (1)*60}:2);
				\coordinate (v3) at ({90 - (2)*60}:2);
				\coordinate (v4) at ({90 - (3)*60}:2);
				\coordinate (v5) at ({90 - (4)*60}:2);
				\coordinate (v6) at ({90 - (5)*60}:2);
				
				% hexagon
				\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
				
				% labels
				\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
				\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
				\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
				\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
				\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
				\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
				
				% flip around 1--4 axis
				\draw[dashed, LightBlueZB] (v1) -- (v4);
				
				% block failure visualization
				\draw[very thick, red!80] (v1)--(v5);
				\filldraw[red!80] (v1) circle (3pt);
				\filldraw[red!80] (v5) circle (3pt);
			\end{scope}
		
			\draw[->] (-.5,0) --node[midway, above]{$ \textcolor{LightBlueZB}{f} $} (.5,0);
		\end{tikzpicture}
	\end{center}
	Then $ \textcolor{LightBlueZB}{f} \cdot \{1, 3\} = \{1, 5\} $ neither permutes nor translates $ \{1, 3\} $
\end{frame}

\begin{frame}{Blocks and block systems}
	% We capture this behavior rigorously:
	\begin{center}
		\vspace{-5pt}\begin{columns}
			\begin{column}{0.6\textwidth}
				\begin{itemize}
					\item Let $ \cdot : \Gamma \times \Omega \rightarrow \Omega $ be an action of $ \Gamma $
					\item A \textit{block} is a set $ \varnothing \neq \Delta \subseteq \Omega $ such that for every $ \gamma \in \Gamma $\begin{itemize}
						\item $ \gamma \cdot \Delta = \Delta $ \textbf{or}
						\item $ (\gamma \cdot \Delta) \cap \Delta = \varnothing $
					\end{itemize}
				\end{itemize}
			\end{column}
			\begin{column}{0.4\textwidth}
				\begin{itemize}
					\item A \textit{block system} of a block $ \Delta $ is the set $ \{\gamma \cdot \Delta \mid \gamma \in \Gamma\} $
					\item \textit{Trivial blocks}: $ \Omega $ and $ \{\omega\} $ for $ \omega \in \Omega $
				\end{itemize}
			\end{column}
		\end{columns}
	\end{center}
	Block systems of non-trivial blocks in above example:
	\vspace{-5pt}\begin{center}
		\begin{tikzpicture}[scale=.8, thick]
			\begin{scope}[shift={(-3,0)}]
				% hexagon vertices
				\coordinate (v1) at ({90 - (0)*60}:2);
				\coordinate (v2) at ({90 - (1)*60}:2);
				\coordinate (v3) at ({90 - (2)*60}:2);
				\coordinate (v4) at ({90 - (3)*60}:2);
				\coordinate (v5) at ({90 - (4)*60}:2);
				\coordinate (v6) at ({90 - (5)*60}:2);
				
				% hexagon
				\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
				
				% labels
				\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
				\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
				\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
				\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
				\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
				\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
				
				% block system visualization
				% first set
				\draw[very thick, red!80] (v1)--(v4);
				\filldraw[red!80] (v1) circle (3pt);
				\filldraw[red!80] (v4) circle (3pt);
				% second set
				\draw[very thick, OliveGreenZB!80] (v2)--(v5);
				\filldraw[OliveGreenZB!80] (v2) circle (3pt);
				\filldraw[OliveGreenZB!80] (v5) circle (3pt);
				% third set
				\draw[very thick, blue!80] (v3)--(v6);
				\filldraw[blue!80] (v3) circle (3pt);
				\filldraw[blue!80] (v6) circle (3pt);
				
				\node[below=-.1 of l4] {$ \{\textcolor{red!80}{\{1,4\}},\textcolor{OliveGreenZB!80}{\{2,5\}},\textcolor{blue!80}{\{3,6\}}\} $};
			\end{scope}
			\begin{scope}[shift={(3,0)}]
				% hexagon vertices
				\coordinate (v1) at ({90 - (0)*60}:2);
				\coordinate (v2) at ({90 - (1)*60}:2);
				\coordinate (v3) at ({90 - (2)*60}:2);
				\coordinate (v4) at ({90 - (3)*60}:2);
				\coordinate (v5) at ({90 - (4)*60}:2);
				\coordinate (v6) at ({90 - (5)*60}:2);
				
				% hexagon
				\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
				
				% labels
				\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
				\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
				\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
				\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
				\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
				\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
				
				% block system visualization
				% first set
				\draw[very thick, blue!80] (v1)--(v3)--(v5)--cycle;
				\filldraw[blue!80] (v1) circle (3pt);
				\filldraw[blue!80] (v3) circle (3pt);
				\filldraw[blue!80] (v5) circle (3pt);
				% second set
				\draw[very thick, red!80] (v4)--(v6)--(v2)--cycle;
				\filldraw[red!80] (v4) circle (3pt);
				\filldraw[red!80] (v6) circle (3pt);
				\filldraw[red!80] (v2) circle (3pt);
				
				\node[below=-.1 of l4] {$ \{\textcolor{red!80}{\{2,4,6\}},\textcolor{blue!80}{\{1,3,5\}}\} $};
			\end{scope}
		\end{tikzpicture}
	\end{center}
\end{frame}

\begin{frame}{Primitive actions and groups}
	\begin{itemize}
		\item A block $ \Delta $ (and $ \Delta $'s block system) is called \textit{minimal} if there is no non-trivial block $ \Delta' \supsetneq \Delta $
		\item Above example: $ \{\textcolor{red!80}{\{1,4\}},\textcolor{OliveGreenZB!80}{\{2,5\}},\textcolor{blue!80}{\{3,6\}}\} $ and $ \{\textcolor{red!80}{\{2,4,6\}},\textcolor{blue!80}{\{1,3,5\}}\} $ are minimal but $ \{\{1\}, \{2\}, \{3\}, \{4\}, \{5\}, \{6\}\} $ is not
		\item An action $ \cdot : \Gamma \times \Omega \rightarrow \Omega $ of $ \Gamma $ on $ \Omega $ is called \textit{primitive} if it is transitive and has no non-trivial blocks
		\item A group $ \Gamma \le \Sym(\Omega) $ is called \textit{primitive} if the natural action of $ \Gamma $ on $ \Omega $ (namely $ \gamma \cdot \omega := \gamma(\omega) $) is primitive
	\end{itemize}
	\begin{center}
		\vspace{-10pt}\begin{columns}
			\begin{column}{0.5\textwidth}
				\textbf{Example}:\begin{itemize}
					\item The symmetry group of the pentagon is primitive
					\item Indeed, any non-trivial block system would imply a factorization of $ 5 = \abs{\Omega} $
				\end{itemize}
			\end{column}
			\begin{column}{0.4\textwidth}
				\begin{tikzpicture}[scale=.8, thick]
					% pentagon vertices
					\coordinate (v1) at ({90 - (0)*72}:2);
					\coordinate (v2) at ({90 - (1)*72}:2);
					\coordinate (v3) at ({90 - (2)*72}:2);
					\coordinate (v4) at ({90 - (3)*72}:2);
					\coordinate (v5) at ({90 - (4)*72}:2);
					
					% labels
					\node[font=\small] (l1) at ({90 - (0)*72}:2.3) {1};
					\node[font=\small] (l2) at ({90 - (1)*72}:2.3) {2};
					\node[font=\small] (l3) at ({90 - (2)*72}:2.3) {3};
					\node[font=\small] (l4) at ({90 - (3)*72}:2.3) {4};
					\node[font=\small] (l5) at ({90 - (4)*72}:2.3) {5};
					
					% 60 degree rotation arrows
					\draw[->, bend left=20, OliveGreenZB] (l1) to (l2);
					\draw[->, bend left=20, OliveGreenZB] (l2) to (l3);
					\draw[->, bend left=20, OliveGreenZB] (l3) to (l4);
					\draw[->, bend left=20, OliveGreenZB] (l4) to (l5);
					\draw[->, bend left=20, OliveGreenZB] (l5) to (l1);
					
					% flip symmetries
					\draw[dashed, LightBlueZB] (v1)--($ (v3)!0.5!(v4) $);
					\draw[dashed, LightBlueZB] (v2)--($ (v4)!0.5!(v5) $);
					\draw[dashed, LightBlueZB] (v3)--($ (v5)!0.5!(v1) $);
					\draw[dashed, LightBlueZB] (v4)--($ (v1)!0.5!(v2) $);
					\draw[dashed, LightBlueZB] (v5)--($ (v2)!0.5!(v3) $);
					
					% pentagon
					\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--cycle;
				\end{tikzpicture}
			\end{column}
		\end{columns}
	\end{center}
\end{frame}

\begin{frame}{Lifting actions from elements to blocks}
	\begin{center}
		\begin{columns}
			\begin{column}{0.6\textwidth}
				\begin{itemize}
					\item Let $ \cdot : \Gamma \times \Omega \rightarrow \Omega $ be an action of group $ \Gamma $ on a set $ \Omega $
					\item Let $ \{\gamma \cdot \Delta \mid \gamma \in \Gamma\} $ be a block system of some block $ \Delta \subseteq \Omega $
					\item Then $ \cdot $ induces an action \begin{align*}
						\psi_\Delta : \Gamma &\rightarrow \Sym(\{\gamma \cdot \Delta \mid \gamma \in \Gamma\})\\
						\gamma' &\mapsto (\gamma \cdot \Delta) \mapsto (\gamma'\gamma) \cdot \Delta
					\end{align*} on the set of blocks!
					%\item We also denote this action using $ \diamond $: \[
					%	\gamma' \diamond (\gamma \cdot \Delta) := (\gamma'\gamma) \cdot \Delta
					%\]
				\end{itemize}
			\end{column}
			\begin{column}{0.4\textwidth}
				\begin{tikzpicture}[scale=1, thick]
					% hexagon vertices
					\coordinate (v1) at ({90 - (0)*60}:2);
					\coordinate (v2) at ({90 - (1)*60}:2);
					\coordinate (v3) at ({90 - (2)*60}:2);
					\coordinate (v4) at ({90 - (3)*60}:2);
					\coordinate (v5) at ({90 - (4)*60}:2);
					\coordinate (v6) at ({90 - (5)*60}:2);
					
					% fr symmetry
					\coordinate (frp1) at ({90 + (1)*30}:2.5);
					\coordinate (frp2) at ({90 - (5)*30}:2.5);
					\draw[dashed, MagentaZB] (frp1)--(frp2);
					\node[right=.1 of frp1] {$ \textcolor{MagentaZB}{fr} $};
					
					% hexagon
					\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
					
					% labels
					\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
					\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
					\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
					\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
					\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
					\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
					
					% r symmetry
					\draw[->, bend left=20, gray] (l1) to node[midway, above] {$ r $} (l2);
					
					% block system visualization
					% first set
					\draw[very thick, red!80] (v1)--(v4);
					\filldraw[red!80] (v1) circle (3pt);
					\filldraw[red!80] (v4) circle (3pt);
					% second set
					\draw[very thick, OliveGreenZB!80] (v2)--(v5);
					\filldraw[OliveGreenZB!80] (v2) circle (3pt);
					\filldraw[OliveGreenZB!80] (v5) circle (3pt);
					% third set
					\draw[very thick, blue!80] (v3)--(v6);
					\filldraw[blue!80] (v3) circle (3pt);
					\filldraw[blue!80] (v6) circle (3pt);
					
					\node[below=-.1 of l4] (blocksystem) {$ \{\textcolor{red!80}{\underbrace{\{1,4\}}_{\Delta}},\textcolor{OliveGreenZB!80}{\underbrace{\{2,5\}}_{r\cdot\Delta}},\textcolor{blue!80}{\underbrace{\{3,6\}}_{r^2\cdot\Delta}}\} $};
					\node[below=0 of blocksystem] (ex1) {$ \psi_\Delta(\textcolor{gray}{r})(\textcolor{red!80}{\{1,4\}}) = \textcolor{OliveGreenZB!80}{\{2,5\}} $};
					\node[below=0 of ex1] {$ \psi_\Delta(\textcolor{MagentaZB}{fr})(\textcolor{red!80}{\{1,4\}}) = \textcolor{blue!80}{\{3,6\}} $};
				\end{tikzpicture}
			\end{column}
		\end{columns}
	\end{center}
\end{frame}

\begin{frame}{Kernels of block-induced homomorphisms}
	\begin{itemize}
		\item Let $ \psi_\Delta : \Gamma \rightarrow \Sym(\{\gamma \cdot \Delta \mid \gamma \in \Gamma\}) $ be the homomorphism induced by the block $ \Delta \subseteq \Omega $
		\item Clearly, \[
			\KernelOf(\psi_\Delta) = \bigcap_{\gamma \in \Gamma} \Stab_{\psi_\Delta}(\gamma \cdot \Delta)
		\]
	\end{itemize}
	\begin{center}
		\begin{tikzpicture}[scale=1, thick]
				% hexagon vertices
				\coordinate (v1) at ({90 - (0)*60}:2);
				\coordinate (v2) at ({90 - (1)*60}:2);
				\coordinate (v3) at ({90 - (2)*60}:2);
				\coordinate (v4) at ({90 - (3)*60}:2);
				\coordinate (v5) at ({90 - (4)*60}:2);
				\coordinate (v6) at ({90 - (5)*60}:2);
				
				% fr symmetry
				\coordinate (frp1) at ({90 + (1)*30}:2.5);
				\coordinate (frp2) at ({90 - (5)*30}:2.5);
				\draw[dashed, MagentaZB] (frp1)--(frp2);
				\node[right=.1 of frp1] {$ \textcolor{MagentaZB}{fr} $};
				
				% fr^3 symmetry
				\coordinate (fr3p1) at ({90 + (3)*30}:2.5);
				\coordinate (fr3p2) at ({90 - (3)*30}:2.5);
				\draw[dashed, DarkOrangeZB] (fr3p1)--(fr3p2);
				\node at ($ (fr3p1) + (-.1, .3) $) {$ \textcolor{DarkOrangeZB}{fr^3} $};
				
				% fr^5 symmetry
				\coordinate (fr5p1) at ({90 + (5)*30}:2.5);
				\coordinate (fr5p2) at ({90 - (1)*30}:2);
				\draw[dashed, TurquoiseZB] (fr5p1)--(fr5p2);
				\node at ($ (fr5p1) + (-.25, .1) $) {$ \textcolor{TurquoiseZB}{fr^5} $};
				
				% hexagon
				\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
				
				% labels
				\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
				\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
				\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
				\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
				\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
				\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
				
				% r symmetry
				\draw[->, bend left=20, gray] (l1) to node[midway, above] {$ r $} (l2);
				
				% block system visualization
				% first set
				\draw[very thick, red!80] (v1)--(v4);
				\filldraw[red!80] (v1) circle (3pt);
				\filldraw[red!80] (v4) circle (3pt);
				% second set
				\draw[very thick, OliveGreenZB!80] (v2)--(v5);
				\filldraw[OliveGreenZB!80] (v2) circle (3pt);
				\filldraw[OliveGreenZB!80] (v5) circle (3pt);
				% third set
				\draw[very thick, blue!80] (v3)--(v6);
				\filldraw[blue!80] (v3) circle (3pt);
				\filldraw[blue!80] (v6) circle (3pt);
				
				\node (blocksystem) at ($ (l1) + (5.5, -.5) $) {$ \{\textcolor{red!80}{\underbrace{\{1,4\}}_{\Delta}},\textcolor{OliveGreenZB!80}{\underbrace{\{2,5\}}_{r\cdot\Delta}},\textcolor{blue!80}{\underbrace{\{3,6\}}_{r^2\cdot\Delta}}\} $};
				
				% stabilizers
				\node[below=0 of blocksystem] (ex1) {$ \Stab_{\psi_\Delta}(\textcolor{red!80}{\{1,4\}}) = \gen{\textcolor{red!80}{f}, \textcolor{DarkOrangeZB}{fr^3}} $};
				\node[below=0 of ex1] (ex2) {$ \Stab_{\psi_\Delta}(\textcolor{OliveGreenZB!80}{\{2,5\}}) = \gen{\textcolor{OliveGreenZB!80}{fr^4}, \textcolor{MagentaZB}{fr}} $};
				\node[below=0 of ex2] (ex3) {$ \Stab_{\psi_\Delta}(\textcolor{blue!80}{\{3,6\}}) = \gen{\textcolor{blue!80}{fr^2}, \textcolor{TurquoiseZB}{fr^5}} $};
				\node[below=0 of ex3] (hencearr) {\rotatebox[origin=c]{-90}{$ \rightsquigarrow $}};
				\node[below=0 of hencearr] {$ \KernelOf(\psi_\Delta) = \{\id\} $};
		\end{tikzpicture}
	\end{center}
\end{frame}

\begin{frame}{Decomposing groups using block-induced homomorphisms}
	The interesting case is when $ \KernelOf(\psi_\Delta) $ is non-trivial, for example:
	\begin{center}
		\begin{tikzpicture}[scale=1, thick]
			% hexagon vertices
			\coordinate (v1) at ({90 - (0)*60}:2);
			\coordinate (v2) at ({90 - (1)*60}:2);
			\coordinate (v3) at ({90 - (2)*60}:2);
			\coordinate (v4) at ({90 - (3)*60}:2);
			\coordinate (v5) at ({90 - (4)*60}:2);
			\coordinate (v6) at ({90 - (5)*60}:2);
			
			% labels
			\node[font=\small] (l1) at ({90 - (0)*60}:2.3) {1};
			\node[font=\small] (l2) at ({90 - (1)*60}:2.3) {2};
			\node[font=\small] (l3) at ({90 - (2)*60}:2.3) {3};
			\node[font=\small] (l4) at ({90 - (3)*60}:2.3) {4};
			\node[font=\small] (l5) at ({90 - (4)*60}:2.3) {5};
			\node[font=\small] (l6) at ({90 - (5)*60}:2.3) {6};
			
			% f symmetry
			\coordinate (origin) at (0,0);
			\draw[dashed, MagentaZB] (v1)--(v4);
			\node[right=.1 of origin] {$ \textcolor{MagentaZB}{f} $};
			
			% hexagon
			\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--cycle;
			
			% block system visualization
			% first set
			\draw[very thick, blue!80] (v1)--(v3)--(v5)--cycle;
			\filldraw[blue!80] (v1) circle (3pt);
			\filldraw[blue!80] (v3) circle (3pt);
			\filldraw[blue!80] (v5) circle (3pt);
			% second set
			\draw[very thick, red!80] (v4)--(v6)--(v2)--cycle;
			\filldraw[red!80] (v4) circle (3pt);
			\filldraw[red!80] (v6) circle (3pt);
			\filldraw[red!80] (v2) circle (3pt);
			
			% r symmetry
			\draw[->, bend left=20, gray] (l1) to node[midway, above] {$ r $} (l2);
			
			\node (blocksystem) at ($ (l1) + (5.5, -.8) $) {$ \{\textcolor{red!80}{\underbrace{\{2,4,6\}}_{\Delta}},\textcolor{blue!80}{\underbrace{\{1,3,5\}}_{r\cdot\Delta}}\} $};
			
			% stabilizers
			\node[below=0 of blocksystem] (ex1) {$ \Stab_{\psi_\Delta}(\textcolor{red!80}{\{2,4,6\}}) = \gen{\textcolor{gray}{r^2}, \textcolor{MagentaZB}{f}} $};
			\node[below=0 of ex1] (ex2) {$ \Stab_{\psi_\Delta}(\textcolor{blue!80}{\{1,3,5\}}) = \gen{\textcolor{gray}{r^2}, \textcolor{MagentaZB}{f}} $};
			\node[below=0 of ex2] (hencearr) {\rotatebox[origin=c]{-90}{$ \rightsquigarrow $}};
			\node[below=0 of hencearr] {$ \KernelOf(\psi_\Delta) = \gen{\textcolor{gray}{r^2}, \textcolor{MagentaZB}{f}} \cong S_3 $};
		\end{tikzpicture}
	\end{center}
	\begin{itemize}
		\item $ \Gamma $ can be seen as a union of cosets of $ \KernelOf(\psi_\Delta) $
		\item $ \rightsquigarrow $ If $ T $ is a transversal of $ \KernelOf(\psi_\Delta) $ in $ \Gamma $, then every $ \gamma \in \Gamma $ can be written as $ t\sigma $ for some (unique) $ t \in T $ and $ \sigma \in \KernelOf(\psi_\Delta) $
	\end{itemize}
\end{frame}

\begin{frame}{Computing $ \KernelOf(\psi_\Delta) $ efficiently}
	\textbf{\textcolor{DarkRedZB}{Problem}}: Computing $ \KernelOf(\psi_\Delta) $ by intersecting $ \psi_\Delta $'s stabilizers is computationally hard!
	
	\textbf{\textcolor{OliveGreenZB}{Solution}}: Iteratively restrict the acting group to the current stabilizer:
	
	\begin{itemize}
		\item Let $ \{\Delta_1, \dots, \Delta_k\} := \{\gamma \cdot \Delta \mid \gamma \in \Gamma\} $ be the blocks
		\item Compute $ \Stab_{\psi_\Delta}(\Delta_1) $
		\item Compute $ \psi_\Delta^{(1)} := \psi_\Delta\restrict{\Stab_{\psi_\Delta}(\Delta_1)} $
		\item Compute $ \Stab_{\psi_\Delta^{(1)}}(\Delta_2) $
		\item Compute $ \psi_\Delta^{(2)} := \psi_\Delta^{(1)}\restrict{\Stab_{\psi_\Delta^{(1)}}(\Delta_2)} $
		\item Compute $ \Stab_{\psi_\Delta^{(2)}}(\Delta_3) $
		\item $ \dots $
		\item Compute $ \Stab_{\psi_\Delta^{(k-1)}}(\Delta_k) = \KernelOf(\psi_\Delta) $
	\end{itemize}
	$ \rightsquigarrow $ we fully circumvent the need to intersect groups!
\end{frame}

\begin{frame}{Luks's algorithm for string isomorphism}
	\vspace{-3pt}\scalebox{0.84}{
		\begin{minipage}{\linewidth}
			\begin{algorithm}[H]
				\SetAlgoLined
				\KwIn{Strings $ u, v : D \rightarrow \Sigma $, a coset $ \Gamma\sigma $ (where $ \Gamma \le \Sym(D) $ and $ \sigma \in \Sym(D) $) and a $ \Gamma $-invariant set $ \Omega \subseteq D $}
				\KwOut{$ \{\delta \in \Gamma\sigma \mid u^\delta(\omega) = v(\omega)\ \forall \omega \in \Omega\} $ represented as a coset}
				\SetKwFunction{strisoluks}{striso}
				\SetKwProg{strisoluksproc}{Function}{}{end}
				\strisoluksproc{\strisoluks{$ u $, $ v $, $ \Gamma\sigma $, $ \Omega $}}{
					\nl\If{$ \sigma \neq \id $}{
						\nl \Return $ \strisoluks(u, v^{\sigma^{-1}}, \Gamma, \Omega) \sigma $\;
					}
					\nl\If{$ \abs{\Omega} = 1 $}{
						\nl Let $ \omega $ be such that $ \Omega = \{\omega\} $\;
						\nl \Return $ \Gamma $ if $ u(\omega) = v(\omega) $ else $ \varnothing $\;
					}
					\nl\If{the action of $ \Gamma $ on $ \Omega $ is not transitive}{
						\nl Compute an orbit $ \Omega' \subsetneq \Omega $\;
						\nl $ \Gamma'\sigma' := \strisoluks(u, v, \Gamma, \Omega') $\;
						\nl \Return $ \strisoluks(u, v, \Gamma'\sigma', \Omega \setminus \Omega') $\;
					}
					\nl Compute a minimal block $ \Delta $ of the action of $ \Gamma $ on $ \Omega $ and the associated block system $ \{\gamma \cdot \Delta \mid \gamma \in \Gamma\} =: \{\Delta_1, \dots, \Delta_k\}$\;
					\nl Compute $ \KernelOf(\psi_\Delta) = \Stab_{\psi_\Delta^{(k-1)}}(\Delta_k) $\;
					\nl Compute a transversal $ T $ of $ \KernelOf(\psi_\Delta) $ in $ \Gamma $\;
					\nl For each $ t \in T $ compute $ \Theta_t \sigma_t := \strisoluks(u, v, \KernelOf(\psi_\Delta)t, \Omega) $\;
					\nl \Return compression of $ \bigcup_{t \in T} \Theta_t\sigma_t $ into a single coset\;
					% \nl \Return $ \bigcup_{t \in T} \strisoluks(u, v, \KernelOf(\psi_\Delta)t, \Omega) $\;
				}
			\end{algorithm}
		\end{minipage}
	}
\end{frame}

\begin{frame}{From coset case to group case}
	\begin{itemize}
		\item More precisely, Luks's algorithm solves a more general variant of $ \SI $ where we are asked to compute \[
		\Iso_{\Gamma\sigma}(u, v) := \{\delta \in \Gamma\sigma \mid u^\delta = v\}
		\] for a coset $ \Gamma\sigma $ of $ \Gamma \le \Sym(D) $
		\item Clearly, \begin{align*}
			u^\delta = v\ \text{for some}\ \delta \in \Gamma\sigma &\iff u^{\gamma\sigma} = v\ \text{for some}\ \gamma \in \Gamma \\
			&\iff u^\gamma = v^{\sigma^{-1}}\ \text{for some}\ \gamma \in \Gamma
		\end{align*}
		\item $ \rightsquigarrow $ Reduction from coset case to group case is correct
	\end{itemize}
\end{frame}

\begin{frame}{Case when $ \Gamma $ acts intransitively on $ \Omega $}
	\begin{itemize}
		\item Let $ \cdot : \Gamma \times \Omega \rightarrow \Omega $ denote the action of $ \Gamma $ on $ \Omega $
		\item Let $ \omega_1, \dots, \omega_s $ be a transversal of $ \{\Gamma \cdot \omega \mid \omega \in \Omega\} $ (note: $ s \ge 2 $)
	\end{itemize}
	\begin{center}
		\begin{tikzpicture}[thick]
			\coordinate (blockwidth) at (10, 0);
			\coordinate (blockheight) at (0, .75);
			
			\coordinate (omega1sep) at ($ (0, 0)!0.2!(blockwidth) $);
			\coordinate (omega2sep) at ($ (0, 0)!0.4!(blockwidth) $);
			\coordinate (omegam1sep) at ($ (0, 0)!0.6!(blockwidth) $);
			\coordinate (omegam1endsep) at ($ (0, 0)!0.8!(blockwidth) $);
			
			\coordinate (utl) at (0, 0); % top left
			\coordinate (utr) at (blockwidth); % top right
			\coordinate (ubl) at ($ (0,0)-(blockheight) $); % bottom left
			\coordinate (ubr) at ($ (ubl)+(blockwidth) $);
			
			\coordinate (uomega1sept) at ($ (utl-|omega1sep) $);
			\coordinate (uomega1sepb) at ($ (ubl-|omega1sep) $);
			\coordinate (uomega2sept) at ($ (utl-|omega2sep) $);
			\coordinate (uomega2sepb) at ($ (ubl-|omega2sep) $);
			\coordinate (uomegam1sept) at ($ (utl-|omegam1sep) $);
			\coordinate (uomegam1sepb) at ($ (ubl-|omegam1sep) $);
			\coordinate (uomegam1endsept) at ($ (utl-|omegam1endsep) $);
			\coordinate (uomegam1endsepb) at ($ (ubl-|omegam1endsep) $);
			
			\coordinate (vtl) at ($ (ubl)-(blockheight) $); % top left
			\coordinate (vtr) at ($ (vtl) + (blockwidth) $); % top right
			\coordinate (vbl) at ($ (vtl)-(blockheight) $); % bottom left
			\coordinate (vbr) at ($ (vbl)+(blockwidth) $);
			
			\coordinate (vomega1sept) at ($ (vtl-|omega1sep) $);
			\coordinate (vomega1sepb) at ($ (vbl-|omega1sep) $);
			\coordinate (vomega2sept) at ($ (vtl-|omega2sep) $);
			\coordinate (vomega2sepb) at ($ (vbl-|omega2sep) $);
			\coordinate (vomegam1sept) at ($ (vtl-|omegam1sep) $);
			\coordinate (vomegam1sepb) at ($ (vbl-|omegam1sep) $);
			\coordinate (vomegam1endsept) at ($ (vtl-|omegam1endsep) $);
			\coordinate (vomegam1endsepb) at ($ (vbl-|omegam1endsep) $);
			
			\draw (uomega1sept)--(uomega1sepb) (uomega2sept)--(uomega2sepb) (uomegam1sept)--(uomegam1sepb);
			\draw (vomega1sept)--(vomega1sepb) (vomega2sept)--(vomega2sepb) (vomegam1sept)--(vomegam1sepb);
			\draw (utl) -- (utr) -- (ubr) -- (ubl) -- cycle;
			\draw (vtl) -- (vtr) -- (vbr) -- (vbl) -- cycle;
			
			\draw[dashed] (ubl)--(vtl) (uomega1sepb)--(vomega1sept) (uomega2sepb)--(vomega2sept) (uomegam1sepb)--(vomegam1sept) (ubr)--(vtr);
			
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt, mirror}] (utl) -- (ubl) node[pos=0.5,left=10pt,black]{$ u $};
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt, mirror}] (vtl) -- (vbl) node[pos=0.5,left=10pt,black]{$ v $};
			
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (utl) -- (uomega1sept) node[pos=0.5,above=10pt,black]{$ \Gamma \cdot \omega_1 $};
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (uomega1sept) -- (uomega2sept) node[pos=0.5,above=10pt,black]{$ \Gamma \cdot \omega_2 $};
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (uomegam1sept) -- (uomegam1endsept) node[pos=0.5,above=10pt,black]{$ \Gamma \cdot \omega_s $};
			\draw [decorate, decoration = {brace, raise=5pt, amplitude=5pt}] (uomegam1endsept) -- (utr) node[pos=0.5,above=10pt,black]{$ D \setminus \Omega $};
			\draw [red!80, decorate, decoration = {brace, raise=5pt, amplitude=5pt}] ($ (utl) + (0,1) $) -- ($ (uomegam1endsept) + (0,1) $) node[pos=0.5,above=10pt,black]{$ \Omega $};
			
			\coordinate (omegaregsept) at ($ (uomegam1endsept) + (0,1) $);
			\coordinate (omegaregsepb) at ($ (vomegam1endsepb) + (0,-.25) $);
			\draw[dashed, red!80] (omegaregsept)--(omegaregsepb);
			
			\draw ($ (uomega2sepb)!0.5!(uomegam1sept) $) node {$ \dots $};
			\draw ($ (vomega2sepb)!0.5!(vomegam1sept) $) node {$ \dots $};
			
			% dots for the D\Omega region
			\draw ($ (uomegam1endsepb)!0.5!(utr) $) node {$ \dots $};
			\draw ($ (vomegam1endsepb)!0.5!(vtr) $) node {$ \dots $};
			
			\coordinate (solchoffset) at (0, -0.6);
			\coordinate (solch0) at ($ (vbl) + (solchoffset) $);
			\coordinate (solch1) at ($ (vomega1sepb) + (solchoffset) $);
			\coordinate (solch2) at ($ (vomega2sepb) + (solchoffset) $);
			\coordinate (solchsm1) at ($ (vomegam1sepb) + (solchoffset) $);
			\coordinate (solchs) at ($ (vomegam1endsepb) + (solchoffset) $);
			
			\node[opacity=0] (sol0) at (solch0) {$ \Gamma_0\sigma_0 $};
			\node (sol1) at (solch1) {$ \Gamma_1\sigma_1 $};
			\node (sol2) at (solch2) {$ \Gamma_2\sigma_2 $};
			\node (solsm1) at (solchsm1) {$ \Gamma_{s-1}\sigma_{s-1} $};
			\node (sols) at (solchs) {$ \Gamma_s\sigma_s $};
			
			\node[below=1 of sol0] (sol0gr) {$ \Gamma $};
			\node[below=1 of sol1] (sol1gr) {$ \Gamma_1' $};
			\node[below=1 of sol2] (sol2gr) {$ \Gamma_2' $};
			\node[below=1 of solsm1] (solsm1gr) {$ \Gamma_{s-1}' $};
			
			\draw[->, LightBlueZB] (sol0gr) -- (sol1) node[midway, sloped, above, font=\small] {recursion} node[midway, sloped, below, font=\small] {$ \Omega = \Gamma \cdot \omega_1 $};
			\draw[->, LightBlueZB] (sol1)--(sol1gr);
			\draw[->, LightBlueZB] (sol1gr) -- (sol2) node[midway, sloped, above, font=\small] {recursion} node[midway, sloped, below, font=\small] {$ \Omega = \Gamma_1' \cdot \omega_2 $};
			\draw[->, LightBlueZB] (sol2)--(sol2gr);
			\coordinate (recdots) at ($ (sol2gr.north east)!0.5!(solsm1.south west) $);
			\node[LightBlueZB] at (recdots) {\rotatebox[origin=c]{45}{$ \cdots $}};
			\draw[->, LightBlueZB] (sol2gr)--($ (recdots) + (-.25,-.25) $);
			\draw[->, LightBlueZB] ($ (recdots) + (.2,.2) $)--($ (solsm1.south west) + (.1,0) $);
			\draw[->, LightBlueZB] (solsm1)--(solsm1gr);
			\draw[->, LightBlueZB] (solsm1gr) -- (sols) node[midway, sloped, above, font=\small] {recursion} node[midway, sloped, below, font=\small] {$ \Omega = \Gamma_{s-1}' \cdot \omega_s $};
			
			\node[OliveGreenZB] (sollabel) at ($ (sols) + (1,-1) $) {Solution};
			\draw[->, bend right=50, OliveGreenZB] (sollabel) to (sols.east);
		\end{tikzpicture}
	\end{center}
\end{frame}

\section{Analysis of Luks's algorithm}

\begin{frame}{Lifting non-minimal blocks to block-induced blocks}
	Any blocks $ \Delta \subsetneq \Delta' $ of $ \cdot $ can be lifted to blocks of $ \psi_\Delta $ by\begin{itemize}
		\item Writing $ \Delta' $ as a union of blocks in $ \{\gamma \cdot \Delta \mid \gamma \in \Gamma\} $
		\item Treating the sets in that union as elements
	\end{itemize}
	\textbf{Example}:
	\vspace{-20pt}\begin{center}
		\begin{tikzpicture}[scale=1, thick]
			% octagon vertices
			\coordinate (v1) at ({90 - (0)*45}:2);
			\coordinate (v2) at ({90 - (1)*45}:2);
			\coordinate (v3) at ({90 - (2)*45}:2);
			\coordinate (v4) at ({90 - (3)*45}:2);
			\coordinate (v5) at ({90 - (4)*45}:2);
			\coordinate (v6) at ({90 - (5)*45}:2);
			\coordinate (v7) at ({90 - (6)*45}:2);
			\coordinate (v8) at ({90 - (7)*45}:2);
			
			% octagon
			\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--(v7)--(v8)--cycle;
			
			% labels
			\node[font=\small] (l1) at ({90 - (0)*45}:2.3) {1};
			\node[font=\small] (l2) at ({90 - (1)*45}:2.3) {2};
			\node[font=\small] (l3) at ({90 - (2)*45}:2.3) {3};
			\node[font=\small] (l4) at ({90 - (3)*45}:2.3) {4};
			\node[font=\small] (l5) at ({90 - (4)*45}:2.3) {5};
			\node[font=\small] (l6) at ({90 - (5)*45}:2.3) {6};
			\node[font=\small] (l7) at ({90 - (6)*45}:2.3) {7};
			\node[font=\small] (l8) at ({90 - (7)*45}:2.3) {8};
			
			% block system visualization
			% first set
			\draw[very thick, red!80] (v1)--(v5);
			\filldraw[red!80] (v1) circle (3pt);
			\filldraw[red!80] (v5) circle (3pt);
			% second set
			\draw[very thick, OliveGreenZB!80] (v2)--(v6);
			\filldraw[OliveGreenZB!80] (v2) circle (3pt);
			\filldraw[OliveGreenZB!80] (v6) circle (3pt);
			% third set
			\draw[very thick, blue!80] (v3)--(v7);
			\filldraw[blue!80] (v3) circle (3pt);
			\filldraw[blue!80] (v7) circle (3pt);
			% fourth set
			\draw[very thick, DarkOrangeZB] (v4)--(v8);
			\filldraw[DarkOrangeZB] (v4) circle (3pt);
			\filldraw[DarkOrangeZB] (v8) circle (3pt);
			
			% r symmetry
			\draw[->, bend left=20, gray] (l1) to node[midway, above] {$ r $} (l2);
			
			\node (blocksystemofdot1) at ($ (l1) + (5.5, -.45) $) {$ \underbrace{\{\textcolor{red!80}{\underbrace{\{1,5\}}_{\Delta}},\textcolor{OliveGreenZB!80}{\underbrace{\{2,6\}}_{r\cdot\Delta}},\textcolor{blue!80}{\underbrace{\{3,7\}}_{r^2 \cdot\Delta}}, \textcolor{DarkOrangeZB}{\underbrace{\{4,8\}}_{r^3 \cdot \Delta}}\}}_{\text{Block system of}\ \cdot} $};
			\node[below=0 of blocksystemofdot1] (blocksystemofdot2) {$ \underbrace{\{\underbrace{\{\textcolor{red!80}{1},\textcolor{blue!80}{3},\textcolor{red!80}{5},\textcolor{blue!80}{7}\}}_{\Delta'},\underbrace{\{\textcolor{OliveGreenZB!80}{2},\textcolor{DarkOrangeZB}{4},\textcolor{OliveGreenZB!80}{6},\textcolor{DarkOrangeZB}{8}\}}_{r\cdot\Delta'}\}}_{\text{Block system of}\ \cdot} $};
			\node[below=0 of blocksystemofdot2] (hencearr) {\rotatebox[origin=c]{-90}{$ \rightsquigarrow $}};
			\node[below=0 of hencearr] (blocksystemofpsi) {$ \underbrace{\{\{\textcolor{red!80}{\{1,5\}},\textcolor{blue!80}{\{3,7\}}\},\{\textcolor{OliveGreenZB!80}{\{2,6\}}, \textcolor{DarkOrangeZB}{\{4,8\}}\}\}}_{\text{Block system of}\ \psi_\Delta} $};
		\end{tikzpicture}
	\end{center}
	\vspace{-15pt}$ \rightsquigarrow $ Non-minimality of $ \Delta \implies $ Non-primitivity of $ \psi_\Delta $
\end{frame}

\begin{frame}{Flattening blocks of block-induced actions}
	\vspace{-5pt}Any block of $ \psi_\Delta $ induces a block of $ \cdot $ via union, for example:
	\vspace{-5pt}\begin{center}
		\begin{tikzpicture}[scale=.8, thick]
			\begin{scope}[shift={(-4,0)}]
				% octagon vertices
				\coordinate (v1) at ({90 - (0)*45}:2);
				\coordinate (v2) at ({90 - (1)*45}:2);
				\coordinate (v3) at ({90 - (2)*45}:2);
				\coordinate (v4) at ({90 - (3)*45}:2);
				\coordinate (v5) at ({90 - (4)*45}:2);
				\coordinate (v6) at ({90 - (5)*45}:2);
				\coordinate (v7) at ({90 - (6)*45}:2);
				\coordinate (v8) at ({90 - (7)*45}:2);
				
				% octagon
				\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--(v7)--(v8)--cycle;
				
				% labels
				\node[font=\small] (l1) at ({90 - (0)*45}:2.3) {1};
				\node[font=\small] (l2) at ({90 - (1)*45}:2.3) {2};
				\node[font=\small] (l3) at ({90 - (2)*45}:2.3) {3};
				\node[font=\small] (l4) at ({90 - (3)*45}:2.3) {4};
				\node[font=\small] (l5) at ({90 - (4)*45}:2.3) {5};
				\node[font=\small] (l6) at ({90 - (5)*45}:2.3) {6};
				\node[font=\small] (l7) at ({90 - (6)*45}:2.3) {7};
				\node[font=\small] (l8) at ({90 - (7)*45}:2.3) {8};
				
				% block system visualization
				% first set
				\draw[very thick, red!80] (v1)--(v5);
				\filldraw[red!80] (v1) circle (3pt);
				\filldraw[red!80] (v5) circle (3pt);
				% second set
				\draw[very thick, OliveGreenZB!80] (v2)--(v6);
				\filldraw[OliveGreenZB!80] (v2) circle (3pt);
				\filldraw[OliveGreenZB!80] (v6) circle (3pt);
				% third set
				\draw[very thick, blue!80] (v3)--(v7);
				\filldraw[blue!80] (v3) circle (3pt);
				\filldraw[blue!80] (v7) circle (3pt);
				% fourth set
				\draw[very thick, DarkOrangeZB] (v4)--(v8);
				\filldraw[DarkOrangeZB] (v4) circle (3pt);
				\filldraw[DarkOrangeZB] (v8) circle (3pt);
				
				% r symmetry
				\draw[->, bend left=20, gray] (l1) to node[midway, above] {$ r $} (l2);
				
				\node[below=-.1 of l5] (blocksystemofdot1) {$ \underbrace{\{\textcolor{red!80}{\underbrace{\{1,5\}}_{\Delta}},\textcolor{OliveGreenZB!80}{\underbrace{\{2,6\}}_{r\cdot\Delta}},\textcolor{blue!80}{\underbrace{\{3,7\}}_{r^2 \cdot\Delta}}, \textcolor{DarkOrangeZB}{\underbrace{\{4,8\}}_{r^3 \cdot \Delta}}\}}_{\text{Block system of}\ \cdot} $};
			\end{scope}
			\begin{scope}[shift={(4,0)}]
				% octagon vertices
				\coordinate (v1) at ({90 - (0)*45}:2);
				\coordinate (v2) at ({90 - (1)*45}:2);
				\coordinate (v3) at ({90 - (2)*45}:2);
				\coordinate (v4) at ({90 - (3)*45}:2);
				\coordinate (v5) at ({90 - (4)*45}:2);
				\coordinate (v6) at ({90 - (5)*45}:2);
				\coordinate (v7) at ({90 - (6)*45}:2);
				\coordinate (v8) at ({90 - (7)*45}:2);
				
				% octagon
				\draw[very thick] (v1)--(v2)--(v3)--(v4)--(v5)--(v6)--(v7)--(v8)--cycle;
				
				% labels
				\node[font=\small] (l1) at ({90 - (0)*45}:2.3) {1};
				\node[font=\small] (l2) at ({90 - (1)*45}:2.3) {2};
				\node[font=\small] (l3) at ({90 - (2)*45}:2.3) {3};
				\node[font=\small] (l4) at ({90 - (3)*45}:2.3) {4};
				\node[font=\small] (l5) at ({90 - (4)*45}:2.3) {5};
				\node[font=\small] (l6) at ({90 - (5)*45}:2.3) {6};
				\node[font=\small] (l7) at ({90 - (6)*45}:2.3) {7};
				\node[font=\small] (l8) at ({90 - (7)*45}:2.3) {8};
				
				% block system visualization
				% first set
				\draw[very thick, TurquoiseZB] (v1)--(v5);
				\filldraw[TurquoiseZB] (v1) circle (3pt);
				\filldraw[TurquoiseZB] (v5) circle (3pt);
				% second set
				\draw[very thick, MagentaZB] (v2)--(v6);
				\filldraw[MagentaZB] (v2) circle (3pt);
				\filldraw[MagentaZB] (v6) circle (3pt);
				% third set
				\draw[very thick, TurquoiseZB] (v3)--(v7);
				\filldraw[TurquoiseZB] (v3) circle (3pt);
				\filldraw[TurquoiseZB] (v7) circle (3pt);
				% fourth set
				\draw[very thick, MagentaZB] (v4)--(v8);
				\filldraw[MagentaZB] (v4) circle (3pt);
				\filldraw[MagentaZB] (v8) circle (3pt);
				
				% r symmetry
				\draw[->, bend left=20, gray] (l1) to node[midway, above] {$ r $} (l2);
				
				\node[below=-.1 of l5] (blocksystemofdot2) {$ \underbrace{\{\textcolor{TurquoiseZB}{\underbrace{\{1,3,5,7\}}_{\Delta'}},\textcolor{MagentaZB}{\underbrace{\{2,4,6,8\}}_{r\cdot\Delta'}}\}}_{\text{Block system of}\ \cdot} $};
			\end{scope}
		
			\coordinate (blocksystemofdotc) at ($ (blocksystemofdot1)!0.5!(blocksystemofdot2) $);
		
			\node at ($ (blocksystemofdotc) + (0,-2) $) (blocksystemofpsi) {$ \underbrace{\{\{\textcolor{red!80}{\{1,5\}},\textcolor{blue!80}{\{3,7\}}\},\{\textcolor{OliveGreenZB!80}{\{2,6\}}, \textcolor{DarkOrangeZB}{\{4,8\}}\}\}}_{\text{Block system of}\ \psi_\Delta} $};
			
			\draw[->, bend right=50] (blocksystemofdot1.south) to node[midway, left, font=\footnotesize] {has block system} (blocksystemofpsi.west);
			\draw[->, bend right=50] (blocksystemofpsi.east) to node[midway, right, font=\footnotesize] {flattening} (blocksystemofdot2.south);
		\end{tikzpicture}
	\end{center}
	\vspace{-10pt}$ \rightsquigarrow $ Non-primitivity of $ \psi_\Delta \implies $ Non-minimality of $ \Delta $
\end{frame}

\begin{frame}{Primitivity and minimality}
	These constructions hold in general and are the essence of the proof of the following connection between primitivity and minimality:
	
	\begin{theorem}
		Let $ \Gamma $ be a group acting on $ \Omega $ with block $ \Delta \subseteq \Omega $. Then \[
			\psi_\Delta\ \text{is primitive} \iff \Delta\ \text{is minimal}
		\]
	\end{theorem}
\end{frame}

\begin{frame}{Classification of primitive groups and application to $ \Gamma_d $}
	
	A classification of all finite primitive groups is known:
	
	\begin{theorem}[O'Nan-Scott]
		Every finite primitive group $ \Gamma \le \Sym(\Omega) $ is of affine type, of diagonal type, almost simple, the product action of a wreath product or a twisted wreath product.
	\end{theorem}

	Relying on the O'Nan-Scott theorem, it is possible to show that every primitive $ \Gamma_d $-group is of polynomial size:
	
	\begin{theorem}[Babai, Cameron, P\'{a}lfy]
		For every $ d \ge 1 $ there exists $ c $ such that every primitive $ \Gamma_d $-group $ \Gamma \le S_n $ has order at most $ n^c $.
	\end{theorem}
\end{frame}

\begin{frame}{Analysis of case when $ \Gamma $ acts transitively on $ \Omega $}
	We apply the above results to analyze the transitive case of Luks's algorithm:
	
	\begin{itemize}
		\item Since $ \Delta $ is minimal, by above theorem, $ \ImageOf(\psi_\Delta) $ is primitive
		\item By FHT, \[
			\Gamma \in \Gamma_d \implies \Gamma/\KernelOf(\psi_\Delta) \in \Gamma_d \implies \ImageOf(\psi_\Delta) \in \Gamma_d
		\]
		\item $ \rightsquigarrow $ By the Babai-Cameron-P\'{a}lfy theorem, \[
			\abs{T} = \abs{\ImageOf(\psi_\Delta)} \le \abs{D}^{O(1)}
		\]
		\item $ \rightsquigarrow $ The transitive case of Luks's algorithm, excluding costs for recursive calls,\begin{itemize}
			\item runs in polynomial time
			\item makes polynomially many recursive calls
		\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}{Running time of Luks's algorithm}
	TODO
\end{frame}

\begin{frame}{Luks's algorithm for graph isomorphism}
	Combining Luks's algorithm for $ \SI $ with the Babai-Luks reduction from $ \GI $ to $ \SI $ for $ \Gamma_d $-groups yields:
	
	\begin{theorem}[Luks]
		$ \GI $ for graphs of maximum degree $ O(1) $ can be solved in polynomial time.
	\end{theorem}
\end{frame}

\end{document}